function precisionToSatoshiBN(a){return Bitcoin.Util.parseValue(a).divide(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)).toString()))}function precisionToBTC(a){return Bitcoin.Util.formatValue(precisionToSatoshiBN(a))}function precisionFromSatoshi(a){return Bitcoin.Util.formatValue(a.multiply(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)))))}function precisionFromBTC(a){return precisionFromSatoshi(Bitcoin.Util.parseValue(a))}function formatPrecision(a){return formatBTC(precisionToSatoshiBN(a).toString())}var MyWallet=new function(){var i=this;this.skip_init=false;var F="abcaa314-6f67-6705-b384-5d47fbe9d7cc";var ao;var P;var k;var aO;var aq;var x;var e;var aE=0;var X=0;var ay=0;var N=0;var aZ=0;var aM;var h={};var G=[];var H=false;var aC=0;var ax=0;var aH=1000;var L={};var aF;var at;var y=0.5;var J=true;var am=5000;var S=am;var c={};var r;var aU=0;var Z;var ae=[];var D;var Q=60000;var C=false;var af;var ac="en";var av=2;var T=0;var aR=0;var ad=false;var aJ;var aw=false;var Y=false;var aB=false;var A=false;var R=null;var U=null;var t={pbkdf2_iterations:am,fee_policy:0,html5_notifications:false,logout_time:600000,tx_display:0,always_keep_local_backup:false,transactions_per_page:30,additional_seeds:[]};this.setEncryptedWalletData=function(a1){if(!a1||a1.length==0){ao=null;aF=null;return}ao=a1;aF=an()};this.setRealAuthType=function(a1){aU=a1};this.addAdditionalSeeds=function(a1){t.additional_seeds.push(a1)};this.getAdditionalSeeds=function(a1){return t.additional_seeds};this.getLanguage=function(){return ac};this.setLanguage=function(a1){MyStore.put("language",a1);ac=a1};this.addEventListener=function(a1){ae.push(a1)};this.sendEvent=function(a3,a2){for(var a1 in ae){ae[a1](a3,a2)}};this.getLogoutTime=function(){return t.logout_time};this.getSecondPasswordPbkdf2Iterations=function(){return t.pbkdf2_iterations};this.getMainPasswordPbkdf2Iterations=function(){return S};this.getSharedKey=function(){return e};this.getSharedcoinEndpoint=function(){return aJ};this.disableLogout=function(a1){aw=a1};this.getFinalBalance=function(){return aE};this.getTotalSent=function(){return X};this.getTotalReceived=function(){return ay};this.setLogoutTime=function(a1){t.logout_time=a1;clearInterval(Z);Z=setTimeout(i.logout,i.getLogoutTime())};this.getDoubleEncryption=function(){return H};this.getEncryptedWalletData=function(){return ao};this.getFeePolicy=function(){return t.fee_policy};this.setFeePolicy=function(a1){t.fee_policy=parseInt(a1)};this.setAlwaysKeepLocalBackup=function(a1){t.always_keep_local_backup=a1};this.getAlwaysKeepLocalBackup=function(){return t.always_keep_local_backup};this.setNTransactionsPerPage=function(a1){t.transactions_per_page=a1};this.getNTransactionsPerPage=function(){return t.transactions_per_page};this.getGuid=function(){return P};this.getHTML5Notifications=function(){return t.html5_notifications};this.setHTML5Notifications=function(a1){t.html5_notifications=a1};this.getNTransactions=function(){return N};this.getTransactions=function(){return G};this.addressExists=function(a1){return L[a1]!=null};this.getAddressTag=function(a1){return L[a1].tag};this.setAddressTag=function(a2,a1){L[a2].tag=a1};this.getAddressBook=function(){return h};this.getAddressLabel=function(a1){if(L[a1]){return L[a1].label}else{return null}};this.setAddressLabel=function(a1,a2){L[a1].label=a2};this.setAddressBalance=function(a1,a2){L[a1].balance=a2};this.getAddressBookLabel=function(a1){return h[a1]};this.isWatchOnly=function(a1){return !L[a1]||L[a1].priv==null};this.getAddressBalance=function(a1){return L[a1].balance};this.getMixerFee=function(){return y};this.getRecommendIncludeFee=function(){return J};this.deleteAddress=function(a1){delete L[a1]};this.addAddressBookEntry=function(a2,a1){h[a2]=a1};this.getPrivateKey=function(a1){return L[a1].priv};this.setLabel=function(a1,a2){L[a1].label=a2;i.backupWalletDelayed();d()};this.securePost=function(a1,a4,bb,a8){var a7=jQuery.extend({},a4);if(!a4.sharedKey){if(!e||e.length==0||e.length!=36){throw"Shared key is invalid"}var a2=new Date().getTime();var a6=parseInt((a2-aR)/10000);var a5=Crypto.SHA256(e.toLowerCase()+a6);var a3=0;var ba=a5.substring(a3,a3+=8)+"-"+a5.substring(a3,a3+=4)+"-"+a5.substring(a3,a3+=4)+"-"+a5.substring(a3,a3+=4)+"-"+a5.substring(a3,a3+=12);a7.sharedKey=ba;a7.sKTimestamp=a6;a7.sKDebugHexHash=a5;a7.sKDebugTimeOffset=aR;a7.sKDebugOriginalClientTime=a2;a7.sKDebugOriginalSharedKey=e}if(!a4.guid){a7.guid=P}a7.format=a4.format?a4.format:"plain";var a9="text";if(a4.format=="json"){a9="json"}$.ajax({dataType:a9,type:"POST",timeout:60000,url:root+a1,data:a7,success:bb,error:a8})};this.isCorrectMainPassword=function(a1){return aO==a1};function aj(a2,a4){var a1=Crypto.SHA256(a2,{asBytes:true});for(var a3=1;a3<a4;++a3){a1=Crypto.SHA256(a1,{asBytes:true})}return Crypto.util.bytesToHex(a1)}this.setPbkdf2Iterations=function(a1,a3){var a2=function(a4){console.log("Panic "+a4);window.location.reload()};i.getSecondPassword(function(){try{if(H){for(var a4 in L){var a6=L[a4];if(a6.priv){a6.priv=i.encrypt(i.decryptPK(a6.priv),e+aq,a1);if(!a6.priv){throw"addr.priv is null"}}}t.pbkdf2_iterations=a1;x=aj(e+aq,a1)}T=2;S=a1;i.backupWallet("update",function(){a3()},function(){a2(a5)})}catch(a5){a2(a5)}},function(a4){a2(a4)})};this.setDoubleEncryption=function(a3,a1,a5){var a2=function(a6){console.log("Panic "+a6);window.location.reload()};try{if(H==a3){return}if(a3){i.getSecondPassword(function(){try{H=true;aq=a1;for(var a6 in L){var a8=L[a6];if(a8.priv){a8.priv=j(B58.decode(a8.priv));if(!a8.priv){throw"addr.priv is null"}}}x=aj(e+aq,t.pbkdf2_iterations);aq=null;i.getSecondPassword(function(){try{i.checkAllKeys();i.backupWallet("update",function(){a5()},function(){a2(a9)})}catch(a9){a2(a9)}},function(a9){a2(a9)})}catch(a7){a2(a7)}},function(a6){a2(a6)})}else{i.getSecondPassword(function(){try{for(var a6 in L){var a8=L[a6];if(a8.priv){a8.priv=i.decryptPK(a8.priv);if(!a8.priv){throw"addr.priv is null"}}}H=false;aq=null;i.checkAllKeys();i.backupWallet("update",function(){a5()},function(){a2(a7)})}catch(a7){a2(a7)}},function(a6){a2(a6)})}}catch(a4){a2(a4)}};this.unArchiveAddr=function(a1){var a1=L[a1];if(a1.tag==2){a1.tag=null;d();i.backupWalletDelayed("update",function(){i.get_history()})}else{i.makeNotice("error","add-error","Cannot Unarchive This Address")}};this.archiveAddr=function(a1){if(i.getActiveAddresses().length<=1){i.makeNotice("error","add-error","You must leave at least one active address");return}var a1=L[a1];if(a1.tag==null||a1.tag==0){a1.tag=2;d();i.backupWalletDelayed("update",function(){i.get_history()})}else{i.makeNotice("error","add-error","Cannot Archive This Address")}};this.addWatchOnlyAddress=function(a1){return aX(a1)};this.addPrivateKey=function(a1,a3){if(ap()){return false}if(a1==null){throw"Cannot add null key."}if(a3==null){a3={}}var a6=a3.compressed?a1.getBitcoinAddressCompressed().toString():a1.getBitcoinAddress().toString();var a5=j(a1.priv);if(a5==null){throw"Error Encoding key"}var a2=new Bitcoin.ECKey(i.decodePK(a5));if(a6!=a2.getBitcoinAddress().toString()&&a6!=a2.getBitcoinAddressCompressed().toString()){throw"Decoded Key address does not match generated address"}if(aX(a6,a5)){L[a6].tag=1;L[a6].created_time=a3.created_time?a3.created_time:0;L[a6].created_device_name=a3.app_name?a3.app_name:APP_NAME;L[a6].created_device_version=a3.app_version?a3.app_version:APP_VERSION;if(L[a6].priv!=a5){throw"Address priv does not match encoded"}try{ws.send('{"op":"addr_sub", "addr":"'+a6+'"}')}catch(a4){}}else{throw"Unable to add generated private key."}return a6};this._seed=function(a3){rng_seed_time();if(aO||a3){var a1=Crypto.util.bytesToWords(Crypto.SHA256(aO?aO:a3,{asBytes:true}));for(var a2 in a1){rng_seed_int(a1[a2])}}if(!af){af=$("body").data("extra-seed")}if(af){var a1=Crypto.util.bytesToWords(Crypto.util.hexToBytes(af));for(var a2 in a1){rng_seed_int(a1[a2])}}};this.generateNewKey=function(a2){i._seed(a2);var a1=new Bitcoin.ECKey(false);if(i.addPrivateKey(a1)){return a1}};this.setLoadingText=function(a1){$(".loading-text").text(a1)};function O(){try{$(".popover").remove()}catch(a1){}}$(window).resize(function(){$(".modal:visible").center();O()});function aW(a2,a1){a2.click(function(){B(a1.txIndex,a1.result)});a2.find(".show-note").unbind("mouseover").mouseover(function(){var a3=a1.note?a1.note:c[a1.hash];aQ(this,a3,a1.hash)});a2.find(".add-note").unbind("mouseover").mouseover(function(){n(this,a1.hash)});return a2}function u(a2,a8){var a1=0;for(var a4=0;a4<a2.inputs.length;++a4){var a3=a2.inputs[a4].prev_out;if(!a3||!a3.addr){continue}var a7=L[a3.addr];if(a7){var a6=parseInt(a3.value);a1-=a6;if(a8){X+=a6;a7.balance-=a6}}}for(var a5=0;a5<a2.out.length;++a5){var a3=a2.out[a5];if(!a3||!a3.addr){continue}var a7=L[a3.addr];if(a7){var a6=parseInt(a3.value);a1+=a6;if(a8){ay+=a6;a7.balance+=a6}}}return a1}function an(){return Crypto.util.bytesToHex(Crypto.SHA256(ao,{asBytes:true}))}function z(a1){var a2=null;a1.onmessage=function(a9){try{var a6=$.parseJSON(a9.data);if(a6.op=="on_change"){var ba=an();var a8=a6.checksum;console.log("On change old "+ba+" ==  new "+a8);if(a2!=a8&&ba!=a8){a2=a8;M()}}else{if(a6.op=="utx"){var a7=TransactionFromJSON(a6.x);for(var bc in G){if(G[bc].txIndex==a7.txIndex){return}}var be=u(a7,true);if(i.getHTML5Notifications()){i.showNotification({title:be>0?"Payment Received":"Payment Sent",body:"Transaction Value "+formatBTC(be),iconUrl:resource+"cube48.png"})}a7.result=be;aE+=be;N++;a7.setConfirmations(0);playSound("beep");if(ax==0&&aC==0){G.unshift(a7);var bb=false;if(G.length>i.getNTransactionsPerPage()){G.pop();bb=true}}i.sendEvent("on_tx");var a4=aa();if("my-transactions"==a4){if(ax==0&&aC==0){$("#no-transactions").hide();if(t.tx_display==0){var a3=$("#transactions-compact").show();aW($(E(a7,L,h)),a7).prependTo(a3.find("tbody")).find("div").hide().slideDown("slow");if(bb){a3.find("tbody tr:last-child").remove()}}else{var a3=$("#transactions-detailed").show();a3.prepend(a7.getHTML(L,h));if(bb){a3.find("div:last-child").remove()}setupSymbolToggle()}}}else{d()}}else{if(a6.op=="block"){for(var a5=0;a5<a6.x.txIndexes.length;++a5){for(var bd=0;bd<G.length;++bd){if(G[bd].txIndex==a6.x.txIndexes[a5]){if(G[bd].blockHeight==null||G[bd].blockHeight==0){G[bd].blockHeight=a6.x.height;break}}}}aD(BlockFromJSON(a6.x));i.sendEvent("on_block");ab()}}}}catch(a9){console.log(a9);console.log(a9.data)}};a1.onopen=function(){i.sendEvent("ws_on_open");az("ok");var a6='{"op":"blocks_sub"}';if(P!=null){a6+='{"op":"wallet_sub","guid":"'+P+'"}'}try{var a4=i.getActiveAddresses();for(var a3 in a4){a6+='{"op":"addr_sub", "addr":"'+a4[a3]+'"}'}}catch(a5){alert(a5)}a1.send(a6)};a1.onclose=function(){i.sendEvent("ws_on_close");az("error")}}var aV="ok";function az(a2){var a1=$("#logout");if(a2=="loading_start"){a1.attr("src",resource+"logout-orange.png");return}else{if(a2!="loading_stop"){aV=a2}}if(aV=="ok"){a1.attr("src",resource+"logout.png")}else{if(aV=="error"){a1.attr("src",resource+"logout-red.png")}}}this.showNotification=function(a1,a2){try{var a4;if(window.webkitNotifications&&webkitNotifications.checkPermission()==0){a4=webkitNotifications.createNotification(a1.iconUrl,a1.title,a1.body);a4.show()}else{if(window.Notification&&window.Notification.permissionLevel()=="granted"){a4=new window.Notification(a1.title,a1).show()}}if(a4){setTimeout(function(){a4.cancel()},a2?a2:5000)}}catch(a3){}};this.makeNotice=function(a2,a5,a4,a3){if(a4==null||a4.length==0){return}console.log(a4);var a1=$('<div class="alert alert-block alert-'+a2+'"></div>');a1.text(""+a4);if($("#"+a5).length>0){a1.attr("id",a5);return}$("#notices").append(a1).hide().fadeIn(200);(function(){var a6=a1;setTimeout(function(){a6.fadeOut(250,function(){$(this).remove()})},a3?a3:5000)})()};this.pkBytesToSipa=function(a1,a5){var a2=new Bitcoin.ECKey(a1);while(a1.length<32){a1.unshift(0)}a1.unshift(128);if(a2.getBitcoinAddress().toString()==a5){}else{if(a2.getBitcoinAddressCompressed().toString()==a5){a1.push(1)}else{throw"Private Key does not match bitcoin address"+a5}}var a3=Crypto.SHA256(Crypto.SHA256(a1,{asBytes:true}),{asBytes:true});a1=a1.concat(a3.slice(0,4));var a4=B58.encode(a1);return a4};function aL(a1){return a1}function aA(a1){return i.decryptPK(a1)}function ah(a1){var a2=i.decodePK(a1);return Crypto.util.bytesToBase64(a2)}function l(a1){var a2=i.decodePK(a1);return Crypto.util.bytesToHex(a2)}this.base58ToSipa=function(a1,a2){return i.pkBytesToSipa(i.decodePK(a1),a2)};this.makeWalletJSON=function(a1){return i.makeCustomWalletJSON(a1,P,e)};this.makeCustomWalletJSON=function(a6,a2,a8){var a5=aL;if(a6=="base64"){a5=ah}else{if(a6=="hex"){a5=l}else{if(a6=="sipa"){a5=i.base58ToSipa}else{if(a6=="base58"){a5=aA}}}}var a1='{\n	"guid" : "'+a2+'",\n	"sharedKey" : "'+a8+'",\n';if(H&&x!=null&&a5==aL){a1+='	"double_encryption" : '+H+',\n	"dpasswordhash" : "'+x+'",\n'}if(t){a1+='	"options" : '+JSON.stringify(t)+",\n"}a1+='	"keys" : [\n';for(var a4 in L){var a7=$.extend({},L[a4]);if(a7.tag==1){delete a7.tag}if(a7.priv!=null){a7.priv=a5(a7.priv,a7.addr)}for(var a3 in a7){if(a7[a3]===null||a7[a3]===undefined){delete a7[a3]}}delete a7.balance;a1+=JSON.stringify(a7)+",\n";atLeastOne=true}if(atLeastOne){a1=a1.substring(0,a1.length-2)}a1+="\n	]";if(aK(h)>0){a1+=',\n	"address_book" : [\n';for(var a4 in h){a1+='	{"addr" : "'+a4+'",\n';a1+='	 "label" : "'+h[a4]+'"},\n'}a1=a1.substring(0,a1.length-2);a1+="\n	]"}if(R){a1+=',\n "hd_wallets" : '+JSON.stringify(R)}if(aK(c)>0){a1+=',\n	"tx_notes" : '+JSON.stringify(c)}a1+="\n}";return a1};this.get_history=function(a2,a1){BlockchainAPI.get_history(function(a3){K(a3,false);if(G.length==0&&aC>0){i.setPage(0)}else{d()}if(a2){a2()}},function(){if(a1){a1()}},ax,aC*i.getNTransactionsPerPage(),i.getNTransactionsPerPage())};this.deleteAddressBook=function(a1){delete h[a1];i.backupWalletDelayed();$("#send-coins").find(".tab-pane").trigger("show",true)};function v(a1){$("#send-coins").find(".tab-pane.active").trigger("show",a1);if(a1){BlockchainAPI.get_ticker();$(".send").prop("disabled",false)}}function m(a1,a2,a6){var a5=a1.val();a1.empty();for(var a4 in L){var a7=L[a4];if(!a7||a7.tag==2){continue}var a3=a7.label;if(!a3){a3=a7.addr.substring(0,15)+"..."}if(a2||a7.balance>0){a1.prepend('<option value="'+a7.addr+'">'+a3+" - "+formatBTC(a7.balance)+"</option>")}}a1.prepend('<option value="any" selected>Any Address</option>');if(!a6&&a5){a1.val(a5)}}function s(a3,a4){m(a3.find('select[name="from"]'),false,a4);m(a3.find('select[name="change"]'),true,a4);a3.find('select[name="change"]').prepend('<option value="new">New Address</option>');a3.find(".local-symbol").text(symbol_local.symbol);a3.find(".btc-symbol").text(symbol_btc.symbol);if(a4){a3.find("input").val("");a3.find(".send-value-usd").text(formatSymbol(0,symbol_local)).val("");a3.find(".amount-needed").text(0)}var a2=a3.find(".recipient-container");if(a4){var a6=a2.find(".recipient:first-child").clone();a2.empty().append(a6)}function a1(){var a7=BigInteger.ZERO;a3.find(".send-value").each(function(){a7=a7.add(precisionToSatoshiBN($(this).val()))});return a7}function a5(a7){a7.find('input[name="send-to-address"]').typeahead({source:aG()}).next().unbind().click(function(){var a8=$(this).prev();i.scanQRCode(function(a9){console.log(a9);try{new Bitcoin.Address(a9);a8.val(a9)}catch(ba){i.handleURI(a9,a7)}},function(a9){i.makeNotice("error","misc-error",a9)})});a7.find(".send-value").unbind().bind("keyup change",function(a8){if(a8.keyCode=="9"){return}a3.find(".amount-needed").text(formatBTC(a1().toString()));a7.find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});a7.find(".send-value-usd").text(formatSymbol(0,symbol_local)).unbind().bind("keyup change",function(a8){if(a8.keyCode=="9"){return}a7.find(".send-value").val(formatSatoshi(parseFloat($(this).val())*symbol_local.conversion,sShift(symbol_btc),true))})}a2.find(".recipient").each(function(){a5($(this))});a3.find(".remove-recipient").unbind().click(function(){var a7=a2.find(".recipient").length;if(a7>1){if(a7==2){$(this).hide(200)}a2.find(".recipient:last-child").remove()}});a3.find(".add-recipient").unbind().click(function(){var a7=a2.find(".recipient:first-child").clone();a7.find('input[type="text"]').val("");a7.appendTo(a2);a5(a7);a3.find(".remove-recipient").show(200)});a3.find('select[name="from"]').unbind().change(function(){var a9=0;var a7=$(this).val();for(var a8 in a7){if(a7[a8]=="any"){$(this).val("any");a9=aE;break}else{var ba=L[a7[a8]];if(ba&&ba.balance){a9+=ba.balance}}}a3.find(".amount-available").text(formatBTC(a9))}).trigger("change")}this.getAllAddresses=function(){var a2=[];for(var a1 in L){a2.push(a1)}return a2};this.getPreferredAddress=function(){var a2=null;for(var a1 in L){var a3=L[a1];if(a2==null){a2=a3}if(a3.priv!=null){if(a2==null){a2=a3}if(a3.tag==null||a3.tag==0){a2=a3;break}}}return a2.addr};function aY(){var a1=$("#restore-backup-modal");a1.modal({keyboard:true,backdrop:"static",show:true});a1.find(".btn.btn-secondary").unbind().click(function(){a1.modal("hide")})}this.scanQRCode=function(a3,a1){var a2=$("#qr-code-reader-modal");a2.modal({keyboard:false,backdrop:"static",show:true});loadScript("wallet/qr.code.reader",function(){QRCodeReader.init(a2,function(a4){QRCodeReader.stop();a2.modal("hide");a3(a4)},function(a4){a2.modal("hide");a1(a4)})},a1);a2.find(".btn.btn-secondary").unbind().click(function(){QRCodeReader.stop();a2.modal("hide");a1()})};this.getActiveAddresses=function(){var a3=[];for(var a1 in L){var a2=L[a1];if(a2.tag!=2){a3.push(a2.addr)}}return a3};this.getArchivedAddresses=function(){var a3=[];for(var a1 in L){var a2=L[a1];if(a2.tag==2){a3.push(a2.addr)}}return a3};this.getLatestBlock=function(){return aM};function aD(a4){if(a4!=null){aM=a4;for(var a2 in G){var a1=G[a2];if(a1.blockHeight!=null&&a1.blockHeight>0){var a3=aM.height-a1.blockHeight+1;if(a3<=100){a1.setConfirmations(aM.height-a1.blockHeight+1)}else{a1.setConfirmations(null)}}else{a1.setConfirmations(0)}}i.sendEvent("did_set_latest_block")}}function B(a2,a1){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Transaction Summary",description:"",src:root+"tx-summary/"+a2+"?result="+a1+"&symbol_btc="+symbol_btc.code+"&symbol_local="+symbol_local.code})})}this.deleteNote=function(a1){delete c[a1];d();i.backupWalletDelayed()};function ak(a1){return/^[\w\-,._  ]+$/.test(a1)}function n(a1,a2){(function(a4,a6){a4=$(a4);try{a4.data("popover").tip().remove();a4.removeData("popover")}catch(a7){}console.log("addNotePopover()");a4.popover({title:'Add Note <span style="float:right"><i class="icon-remove-sign"></i></span>',trigger:"manual",content:'<textarea style="width:97%;height:50px;margin-top:2px" placeholder="Enter the note here..."></textarea><div style="text-align:right"><button class="btn btn-small">Save</button></div>'});a4.popover("show");a4.unbind("mouseleave").mouseleave(function(){if(!a4.__timeout){a4.__timeout=setTimeout(function(){a4.popover("hide")},250)}});function a3(){if(a4.__timeout){clearTimeout(a4.__timeout);a4.__timeout=null}}var a5=a4.data("popover").tip().mouseenter(a3);a5.find("textarea").focus(a3);a5.mouseleave(function(){a4.__timeout=setTimeout(function(){a4.popover("hide")},250)});a5.find("i").unbind().click(function(){a4.popover("hide")});a5.find("button").click(function(){var a8=$.trim(a5.find("textarea").val());if(!ak(a8)){i.makeNotice("error","misc-error","Note must be contain letters and numbers only");return}if(a8.length>0){c[a6]=a8;i.backupWalletDelayed()}d()})})(a1,a2)}function aQ(a1,a2,a3){(function(a4,a5,a7){a4=$(a4);try{a4.data("popover").tip().remove();a4.removeData("popover")}catch(a8){}var a9="Note";if(c[a7]){a9+=' <span style="float:right"><img src="'+resource+'delete.png" /></span>'}a4.popover({title:a9,trigger:"manual",content:a5});a4.popover("show");a4.unbind("mouseleave").mouseleave(function(){if(!a4.__timeout){a4.__timeout=setTimeout(function(){a4.popover("hide")},250)}});var a6=a4.data("popover").tip().mouseenter(function(){if(a4.__timeout){clearTimeout(a4.__timeout);a4.__timeout=null}});a6.find("img").unbind().click(function(){i.deleteNote(a7)});a6.mouseleave(function(){a4.__timeout=setTimeout(function(){a4.popover("hide")},250)})})(a1,a2,a3)}function E(a4,a9,a6){var ba=a4.result;var a5='<tr class="pointer" id="tx-'+a4.txIndex+'"><td class="hidden-phone" style="width:365px"><div><ul style="margin-left:0px;" class="short-addr">';var a2=true;if(ba>=0){for(var a3=0;a3<a4.inputs.length;++a3){var a1=a4.inputs[a3].prev_out;if(!a1||!a1.addr){a2=false;a5+='<span class="label">Newly Generated Coins</span>'}else{var a7=a9[a1.addr];if(a7){continue}a2=false;a5+=formatOutput(a1,a9,a6)}}}else{if(ba<0){for(var a3=0;a3<a4.out.length;++a3){var a1=a4.out[a3];var a7=a9[a1.addr];if(a7&&a1.type==0){continue}a2=false;a5+=formatOutput(a1,a9,a6)}}}if(a2){a5+='<span class="label">Moved Between Wallet</info>'}a5+="</ul></div></td><td><div>";var a8=a4.note?a4.note:c[a4.hash];if(a8){a5+='<img src="'+resource+'note.png" class="show-note"> '}else{a5+='<img src="'+resource+'note_grey.png" class="add-note"> '}if(a4.time>0){a5+=dateToString(new Date(a4.time*1000))}if(a4.confirmations==0){a5+=' <span class="label label-important hidden-phone">Unconfirmed Transaction!</span> '}else{if(a4.confirmations>0){a5+=' <span class="label label-info hidden-phone">'+a4.confirmations+" Confirmations</span> "}}a5+="</div></td>";if(ba>0){a5+='<td style="color:green"><div>'+formatMoney(ba,true)+"</div></td>"}else{if(ba<0){a5+='<td style="color:red"><div>'+formatMoney(ba,true)+"</div></td>"}else{a5+="<td><div>"+formatMoney(ba,true)+"</div></td>"}}if(a4.balance==null){a5+="<td></td></tr>"}else{a5+='<td class="hidden-phone"><div>'+formatMoney(a4.balance)+"</div></td></tr>"}return a5}function aa(){O();if(aE==null){$("#balance").html("Loading...")}else{$("#balance").html(formatSymbol(aE,symbol,true));$("#balance2").html(formatSymbol(aE,(symbol===symbol_local)?symbol_btc:symbol_local),true)}return k.attr("id")}function d(a1){var a2=aa();if("send-coins"==a2){v(a1)}else{if("home-intro"==a2){f(a1)}else{if("receive-coins"==a2){a0(a1)}else{if("my-transactions"==a2){ab(a1)}}}}}function f(a1){$("#summary-n-tx").html(N);$("#summary-received").html(formatMoney(ay,true));$("#summary-sent").html(formatMoney(X,true));$("#summary-balance").html(formatMoney(aE,symbol));$(".paper-wallet-btn").unbind().click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showModal()})});var a3=i.getPreferredAddress();if(a3==null){return}if(i.isWatchOnly(a3)){$(".no-watch-only").hide()}else{$(".no-watch-only").show();var a2=$("#my-primary-address");if(a2.text()!=a3){a2.text(a3);loadScript("wallet/jquery.qrcode",function(){$("#my-primary-addres-qr-code").empty().qrcode({width:125,height:125,text:a3})})}}$("#tweet-for-btc").unbind().click(function(){i.openWindow("https://twitter.com/share?url=https://blockchain.info/wallet&hashtags=tweet4btc,bitcoin,"+a3+"&text=Sign Up For a Free Bitcoin Wallet @ Blockchain.info")})}function W(){var a1=$("#export-warning").show();var a2=$("#import-export-content").hide();$("#show-import-export").unbind().click(function(){i.getMainPassword(function(){a1.hide();loadScript("wallet/import-export",function(){ImportExport.init(a2,function(){a2.show()},function(){al($("#home-intro"))})},function(a3){i.makeNotice("error","misc-error",a3);al($("#home-intro"))})},function(){al($("#home-intro"))})})}function ab(){var a2=null;var a4=0;if(a2!=null){clearInterval(a2);a2=null}var a1;if(t.tx_display==0){$("#transactions-detailed").hide();a1=$("#transactions-compact").show().find("tbody").empty()}else{$("#transactions-compact").hide();a1=$("#transactions-detailed").empty().show()}if(G.length==0){$("#transactions-detailed, #transactions-compact").hide();$("#no-transactions").show();return}else{$("#no-transactions").hide()}var a3=function(){for(var a8=a4;a8<G.length&&a8<(a4+i.getNTransactionsPerPage());++a8){var a7=G[a8];if(t.tx_display==0){a1.append(aW($(E(a7,L,h)),a7))}else{a1.append(a7.getHTML(L,h))}}a4+=i.getNTransactionsPerPage();if(a4<G.length){a2=setTimeout(a3,15)}else{setupSymbolToggle();O();var a6=$(".pagination ul").empty();if(aC==0&&G.length<i.getNTransactionsPerPage()){a6.hide();return}else{a6.show()}var a5=Math.ceil(aZ/i.getNTransactionsPerPage());var ba=" disabled";if(aC>0){ba=""}var bb=10;var a9=Math.max(0,Math.min(aC-(bb/2),a5-bb));a6.append($('<li class="prev'+ba+'"><a>&larr; Previous</a></li>').click(function(){i.setPage(aC-1)}));if(a9>0){a6.append($("<li><a>≤</a></li>").click(function(){i.setPage(0)}))}for(var a8=a9;a8<a5&&a8<a9+bb;++a8){(function(bc){var bd="";if(aC==bc){bd=' class="active"'}a6.append($("<li"+bd+'><a class="hidden-phone">'+(bc+1)+"</a></li>").click(function(){i.setPage(bc)}))})(a8)}if(a9+bb<a5){a6.append($("<li><a>≥</a></li>").click(function(){i.setPage(a5-1)}))}var ba=" disabled";if(aC<a5-1){ba=""}a6.append($('<li class="next'+ba+'"><a>Next &rarr;</a></li>').click(function(){i.setPage(aC+1)}))}};a3()}this.setPage=function(a1){aC=a1;scroll(0,0);i.get_history()};function w(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Export History",description:"",src:root+"export-history?active="+i.getActiveAddresses().join("|")+"&archived="+i.getArchivedAddresses().join("|")})})}function aP(a1){$.ajax({type:"GET",dataType:"json",url:"https://blockchain.info/adverts_feed",timeout:60000,success:function(a2){if(a2&&a2.partners){V(a2.partners)}},error:function(a2){}})}function V(a9){var a2=$("#partner-home-buttons");if(a9.home_buttons&&a9.home_buttons.length>0){a2.show();a2.find("p").empty();for(var bj in a9.home_buttons){var a1=a9.home_buttons[bj];var bh=$('<a class="btn" style="margin-left:3px;margin-bottom:3px;" href="" target="blank"><img src=""></a>');if(a1.button_class){bh.addClass(a1.button_class)}bh.attr("href",a1.link);bh.text(" "+a1.title);if(a1.image){bh.prepend("<img>").find("img").attr("src",a1.image.replace("{0}",resource))}a2.find("p").append(bh)}}else{a2.hide()}var a6=$("#send-coins-nav");a6.find("li.send_partner").remove();var bi=$("#partners-send-divider");if(a9.send_buttons&&a9.send_buttons.length>0){bi.show().next().show();for(var bj in a9.send_buttons){var a1=a9.send_buttons[bj];var a3=$('<li class="send_partner"><a target="blank"></a></li>');var bh=a3.find("a");bh.attr("href",a1.link);bh.text(" "+a1.title);if(a1.image){bh.prepend('<i class="icon-dice" style="background-position:0px;width:16px;height:16px;"></i>').find("i").css("background-image","url("+a1.image.replace("{0}",resource)+")")}bi.next().after(a3)}}else{bi.hide().next().hide()}var bg=$("#home-deposit-container").empty();if(a9.deposit_buttons.length>0){bg.show();var bb=$('<ul id="myTab" class="nav nav-tabs">');var a7={US:[],GB:[],EU:[]};var a4=[];for(var bj in a9.deposit_buttons){var a1=a9.deposit_buttons[bj];if(a1.country_code==null||a1.country_code.length==0){a4.push(a1);continue}var a5=a7[a1.country_code];if(a5==null){a5=[];a7[a1.country_code]=a5}a5.push(a1)}var a8=0;for(var bc in a7){var a5=a7[bc];if(a5.length==0&&a4.length==0){continue}var ba=$("<li><a></a></li>");if(a8==0){ba.addClass("active")}var bh=ba.find("a");bh.attr("href","#deposit-"+bc.toLowerCase());bh.text(" "+bc.toUpperCase());bh.prepend("<img>").find("img").attr("src",resource+"flags/"+bc.toLowerCase()+".png");++a8;bb.append(ba)}bb.find("a").click(function(){$(this).tab("show")});bg.append(bb);var be=$('<div class="tab-content page-header">');var a8=0;for(var bc in a7){var a5=a7[bc];var bd=$('<div class="tab-pane" style="text-align:right">');if(a8==0){bd.addClass("active")}bd.attr("id","deposit-"+bc.toLowerCase());a5=a5.concat(a4);if(a5.length==0){continue}for(var bf in a5){var a1=a5[bf];var bh=$('<a style="margin-left:3px;" class="btn" target="blank"></a>');if(a1.button_class){bh.addClass(a1.button_class)}bh.attr("href",a1.link);bh.text(" "+a1.title);if(a1.image){bh.prepend("<img>").find("img").attr("src",a1.image.replace("{0}",resource))}bd.append(bh)}++a8;be.append(bd)}bg.append(be)}else{bg.hide()}}function K(a4,a3){if(!a3){if(a4.mixer_fee){y=a4.mixer_fee}J=a4.recommend_include_fee;if(a4.info){if(a4.info.symbol_local){setLocalSymbol(a4.info.symbol_local)}if(a4.info.symbol_btc){setBTCSymbol(a4.info.symbol_btc)}if(a4.info.notice){i.makeNotice("error","misc-error",a4.info.notice)}}}if(a4.disable_mixer){$("#shared-addresses,#send-shared").hide()}aJ=a4.sharedcoin_endpoint;G.length=0;if(a4.wallet==null){ay=0;X=0;aE=0;N=0;aZ=0;return}ay=a4.wallet.total_received;X=a4.wallet.total_sent;aE=a4.wallet.final_balance;N=a4.wallet.n_tx;aZ=a4.wallet.n_tx_filtered;for(var a2=0;a2<a4.addresses.length;++a2){if(L[a4.addresses[a2].address]){L[a4.addresses[a2].address].balance=a4.addresses[a2].final_balance}}for(var a2=0;a2<a4.txs.length;++a2){var a1=TransactionFromJSON(a4.txs[a2]);a1.result=u(a1,false);G.push(a1)}if(!a3){if(a4.info.latest_block){aD(a4.info.latest_block)}}i.sendEvent("did_multiaddr")}this.handleURI=function(a2,a1){loadScript("wallet/jsuri-1.1.1",function(){try{var a4=new Uri(a2);var a3=new Bitcoin.Address(a4.host());a1.find('input[name="send-to-address"]').val(a3.toString());var a5=parseFloat(a4.getQueryParamValue("amount"));if(a5>0&&!isNaN(a5)){a1.find(".send-value").val(a5)}}catch(a6){console.log(a6);i.makeNotice("error","error","Invalid Bitcoin Address or URI")}},function(){i.makeNotice("error","error","Invalid Bitcoin Address or URI")})};function aS(){M();Z=setTimeout(i.logout,i.getLogoutTime());i.sendEvent("did_decrypt");i.get_history(null,function(){MyStore.get("multiaddr",function(a4){if(a4!=null){K($.parseJSON(a4),true);d()}})});$("#initial_error,#initial_success").remove();var a3=decodeURIComponent(window.location.hash.replace("#",""));if(a3.indexOf("bitcoin:")==0){var a1=$("#send-coins");al(a1);var a2=a1.find(".tab-pane.active").find(".recipient").first();i.handleURI(a3,a2)}else{al($("#home-intro"))}window.location.hash=""}function g(a1,a4,a2){var a3={method:"wallet.aes.json",format:"json",checksum:a1};i.securePost("wallet",a3,function(a5){if(!a5.payload||a5.payload=="Not modified"){if(a4){a4()}}else{if(a2){a2()}}},function(a5){if(a2){a2()}})}function M(a3,a1){var a2={method:"wallet.aes.json",format:"json"};if(aF&&aF.length>0){a2.checksum=aF}i.setLoadingText("Checking For Wallet Updates");i.securePost("wallet",a2,function(a4){if(a4.storage_token){if(U==null||U.indexOf(a4.storage_token)==-1){MyStore.put("storage_token",(U?U+"|":"")+a4.storage_token)}}if(!a4.payload||a4.payload=="Not modified"){if(a3){a3()}return}i.setEncryptedWalletData(a4.payload);ag(function(){i.get_history();d();if(a3){a3()}},function(){if(a1){a1()}})},function(a4){if(a1){a1()}})}function ag(a2,a1){if(ao==null||ao.length==0){a1("No Wallet Data To Decrypt");return}i.decryptWallet(ao,aO,function(ba,a8){try{e=ba.sharedKey;if(!e||e.length==0||e.length!=36){throw"Shared Key is invalid"}if(a8){T=a8.version;S=a8.pbkdf2_iterations}if(ba.double_encryption&&ba.dpasswordhash){H=ba.double_encryption;x=ba.dpasswordhash}if(ba.options){$.extend(t,ba.options)}L={};for(var a4=0;a4<ba.keys.length;++a4){var a3=ba.keys[a4];if(!a3.addr||!ak(a3.addr)){i.makeNotice("error","null-error","Your wallet contains an invalid address. This is a sign of possible corruption, please double check all your BTC is accounted for. Backup your wallet to remove this error.",15000);continue}if(a3.tag==1||!ak(a3.tag)){a3.tag=null}if(a3.label&&!ak(a3.label)){a3.label=null}L[a3.addr]=a3}h={};if(ba.address_book){for(var a4=0;a4<ba.address_book.length;++a4){var a6=ba.address_book[a4];if(a6.label&&ak(a6.label)&&ak(a6.addr)){i.addAddressBookEntry(a6.addr,a6.label)}}}if(ba.hd_wallets){R=ba.hd_wallets}if(ba.tx_notes){for(var a7 in ba.tx_notes){var a5=ba.tx_notes[a7];if(a5&&ak(a5)){c[a7]=a5}}}if(aF==null||aF.length==0){aF=an()}a();a2()}catch(a9){a1(a9)}},a1)}this.getPassword=function(a6,a7,a4){if(!a6.is(":visible")){a6.trigger("hidden");a6.unbind()}a6.modal({keyboard:false,backdrop:"static",show:true});a6.center();var a5=a6.find('input[name="password"]');var a9=a5,a1=false,a8=false;a6.find(".vkeyboard li").unbind().click(function(){var bc=$(this),bb=bc.html();if(bc.hasClass("left-shift")||bc.hasClass("right-shift")){$(".letter").toggleClass("uppercase");$(".symbol span").toggle();a1=(a1===true)?false:true;a8=false;return false}if(bc.hasClass("capslock")){$(".letter").toggleClass("uppercase");a8=true;return false}if(bc.hasClass("delete")){var ba=a9.val();a9.val(ba.substr(0,ba.length-1));return false}if(bc.hasClass("symbol")){bb=$("span:visible",bc).html()}if(bc.hasClass("space")){bb=" "}if(bc.hasClass("tab")){bb="\t"}if(bc.hasClass("return")){bb="\n"}if(bc.hasClass("uppercase")){bb=bb.toUpperCase()}if(a1===true){$(".symbol span").toggle();if(a8===false){$(".letter").toggleClass("uppercase")}a1=false}a9.val(a9.val()+bb)});a5.keypress(function(ba){if(ba.keyCode==13){ba.preventDefault();a6.find(".btn.btn-primary").click()}});a5.val("");var a2=a6.find(".btn.btn-primary");a2.click(function(){if(a7){a4=null;var ba=a7;a7=null;setTimeout(function(){a6.modal("hide");ba(a5.val())},10)}else{a6.modal("hide")}});var a3=a6.find(".btn.btn-secondary");a3.click(function(){if(a4){var ba=a4;a4=null;a7=null;setTimeout(function(){a6.modal("hide");try{ba()}catch(bb){i.makeNotice("error","misc-error",bb)}},10)}else{a6.modal("hide")}});a6.on("hidden",function(){a5.unbind();a3.unbind();a2.unbind();a6.unbind();if(a4){var ba=a4;a4=null;a7=null;setTimeout(function(){try{ba()}catch(bb){i.makeNotice("error","misc-error",bb)}},10)}})};this.makePairingQRCode=function(a2,a1){i.getMainPassword(function(){loadScript("wallet/jquery.qrcode",function(){try{if(a1==1){i.securePost("wallet",{method:"pairing-encryption-password"},function(a4){a2($("<div></div>").qrcode({width:300,height:300,text:"1|"+P+"|"+i.encrypt(e+"|"+Crypto.util.bytesToHex(UTF8.stringToBytes(aO)),a4,10)}))},function(a4){i.makeNotice("error","misc-error",a4)})}else{if(a1==0){a2($("<div></div>").qrcode({width:300,height:300,text:P+"|"+e+"|"+aO}))}}}catch(a3){i.makeNotice("error","misc-error",a3)}})},function(){i.logout()})};this.getMainPassword=function(a2,a1){if(D>new Date().getTime()-Q){return a2(aO)}i.getPassword($("#main-password-modal"),function(a3){if(aO==a3){D=new Date().getTime();if(a2){try{a2(aO)}catch(a4){i.makeNotice("error","misc-error",a4)}}}else{i.makeNotice("error","misc-error","Password incorrect.");if(a1){try{a1()}catch(a4){i.makeNotice("error","misc-error",a4)}}}},a1)};this.getSecondPassword=function(a3,a1){if(!H||aq!=null){if(a3){try{a3(aq)}catch(a2){i.makeNotice("error","misc-error",a2)}}return}i.getPassword($("#second-password-modal"),function(a4){try{if(i.validateSecondPassword(a4)){if(a3){try{a3(a4)}catch(a5){console.log(a5);i.makeNotice("error","misc-error",a5)}}}else{i.makeNotice("error","misc-error","Password incorrect.");if(a1){try{a1()}catch(a5){i.makeNotice("error","misc-error",a5)}}}}catch(a5){if(a1){try{a1()}catch(a5){i.makeNotice("error","misc-error",a5)}}}},a1)};function b(){if(C||aB){return}function a2(a5){aB=false;i.makeNotice("error","misc-error",a5);i.sendEvent("error_restoring_wallet")}try{aB=true;var a1=$("#restore-password");aO=a1.val();a1.val("");D=new Date().getTime();if(ao==null||ao.length==0){i.setLoadingText("Validating Authentication key");var a3=$.trim($(".auth-"+r).find(".code").val());if(a3.length==0||a3.length>255){throw"You must enter a Two Factor Authentication code"}$.ajax({timeout:60000,type:"POST",url:root+"wallet",data:{guid:P,payload:a3,length:a3.length,method:"get-wallet",format:"plain"},success:function(a5){try{if(a5==null||a5.length==0){throw"Server Return Empty Wallet Data"}if(a5!="Not modified"){i.setEncryptedWalletData(a5)}$(".auth-"+r).hide();$(".auth-0").show();ag(function(){aB=false;o();aS()},a2)}catch(a6){a2(a6)}},error:function(a5){a2(a5.responseText)}})}else{ag(function(){aB=false;o();aS()},a2)}}catch(a4){a2(a4)}}this.getIsInitialized=function(){return C};function a(){if(C){return}az("error");webSocketConnect(z);C=true;$("#tech-faq").hide();$("#intro-text").hide();$("#large-summary").show()}this.connectWebSocket=function(){webSocketConnect(z)};this.quickSendNoUI=function(a3,a2,a1){loadScript("wallet/signer",function(){i.getSecondPassword(function(){try{var a5=initNewTx();a5.webworker_resource_prefix="";a5.from_addresses=i.getActiveAddresses();a5.to_addresses.push({address:new Bitcoin.Address(a3),value:Bitcoin.Util.parseValue(a2)});a5.addListener(a1);a5.start()}catch(a4){a1.on_error(a4)}},function(a4){a1.on_error(a4)})})};function I(){i.setLoadingText("Sending email backup");i.securePost("wallet",{method:"email-backup"},function(a1){i.makeNotice("success","backup-success",a1)},function(a1){i.makeNotice("error","misc-error",a1.responseText)})}this.backupWalletDelayed=function(a4,a3,a2,a1){if(at){clearInterval(at);at=null}at=setTimeout(function(){i.backupWallet(a4,a3,a2,a1)},3000)};this.backupWallet=function(a7,a6,a2){if(at){clearInterval(at);at=null}var a1=function(a8){i.sendEvent("on_backup_wallet_error");i.makeNotice("error","misc-error","Error Saving Wallet: "+a8,10000);M();d();if(a2!=null){a2(a8)}};try{if(a7==null){a7="update"}if(aK(L)==0){throw"Addresses Length 0"}var a3=i.makeWalletJSON();var a5=i.encryptWallet(a3,aO);if(a5.length==0){throw"Error encrypting the JSON output"}i.decryptWallet(a5,aO,function(bc){try{var a9=aF;i.setLoadingText("Saving wallet");i.setEncryptedWalletData(a5);var a8=aF;var ba={length:a5.length,payload:a5,checksum:a8,old_checksum:a9,method:a7,format:"plain",language:ac};if(A){ba.active=i.getActiveAddresses().join("|")}i.securePost("wallet",ba,function(bd){g(a8,function(){for(var be in L){var bf=L[be];if(bf.tag==1){delete bf.tag}}i.makeNotice("success","misc-success",bd);d();if(a6!=null){a6()}i.sendEvent("on_backup_wallet_success")},function(){a1("Checksum Did Not Match Expected Value")})},function(bd){a1(bd.responseText)})}catch(bb){a1(bb)}})}catch(a4){a1(a4)}};function aT(a1){if(H){if(aq==null){throw"Cannot encrypt private key without a password"}return i.encrypt(a1,e+aq,i.getSecondPasswordPbkdf2Iterations())}else{return a1}return null}this.isBase58=function(a3,a2){for(var a1=0;a1<a3.length;++a1){if(a3[a1]<0||a3[a1]>58){return false}}return true};this.encrypt=function(a3,a2,a1){return Crypto.AES.encrypt(a3,a2,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:a1})};this.encryptWallet=function(a2,a1){return JSON.stringify({pbkdf2_iterations:i.getMainPasswordPbkdf2Iterations(),version:2,payload:i.encrypt(a2,a1,i.getMainPasswordPbkdf2Iterations())})};this.decryptWallet=function(a2,ba,bb,a5){try{i.setLoadingText("Decrypting Wallet");i.sendEvent("on_wallet_decrypt_start");var a7=function(bc,bd){i.sendEvent("on_wallet_decrypt_finish");if(bb!=null){bb(bc,bd)}};var a9=function(bc){i.sendEvent("on_wallet_decrypt_finish");if(a5!=null){a5(bc)}};var a1=null;try{var a1=$.parseJSON(a2)}catch(a4){}var a3=function(){try{var bd=Crypto.AES.decrypt(a1.payload,ba,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:a1.pbkdf2_iterations});var bc=$.parseJSON(bd);a7(bc,a1)}catch(be){a9("Error Decrypting Wallet. Please check your password is correct.")}};if(a1&&a1.payload&&a1.pbkdf2_iterations){if(a1.version!=av){throw"Wallet version "+a1.version+" not supported"}if(a1.pbkdf2_iterations>0){var a8=$("#decrypting-progress-modal");var a6=setTimeout(function(){a8.modal({keyboard:false,backdrop:"static",show:true});a8.center()},500);i.decryptWebWorker(a1.payload,ba,a1.pbkdf2_iterations,function(bd){clearTimeout(a6);a8.modal("hide");try{var bc=$.parseJSON(bd);a7(bc,a1)}catch(be){a3()}},function(bc){clearTimeout(a6);a8.modal("hide");a3()})}else{a3()}}else{i.decrypt(a2,ba,10,function(bd){try{var bc=$.parseJSON(bd);try{a7(bc)}catch(be){console.log(be)}return true}catch(be){return false}},function(){a9("Error Decrypting Wallet. Please check your password is correct.")})}}catch(a4){a9(a4)}};this.getWebWorkerLoadPrefix=function(){return resource+"wallet/"};this.decryptWebWorker=function(a4,a8,a3,a9,a7){var a1=false;var a6=function(ba){if(!a1){a7(ba);a1=true}};try{var a2=new Worker(i.getWebWorkerLoadPrefix()+"signer"+(min?".min.js":".js"));a2.addEventListener("message",function(bb){var ba=bb.data;try{switch(ba.cmd){case"on_decrypt":a9(ba.data);a2.terminate();break;case"on_error":throw ba.e}}catch(bb){a2.terminate();a6(bb)}},false);a2.addEventListener("error",function(ba){a6(ba)});a2.postMessage({cmd:"load_resource",path:i.getWebWorkerLoadPrefix()+"bitcoinjs"+(min?".min.js":".js")});a2.postMessage({cmd:"decrypt",data:a4,password:a8,pbkdf2_iterations:a3})}catch(a5){a6(a5)}};this.decrypt=function(a5,a4,a2,a7,a3){try{var a1=Crypto.AES.decrypt(a5,a4,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:a2});if(a1!=null&&a1.length>0){if(a7(a1)){return a1}}}catch(a6){console.log(a6)}if(a2!=10){try{var a1=Crypto.AES.decrypt(a5,a4,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:10});if(a1!=null&&a1.length>0){if(a7(a1)){return a1}}}catch(a6){console.log(a6)}}try{var a1=Crypto.AES.decrypt(a5,a4);if(a1!=null&&a1.length>0){if(a7(a1)){return a1}}}catch(a6){console.log(a6)}try{var a1=Crypto.AES.decrypt(a5,a4,{mode:new Crypto.mode.OFB(Crypto.pad.iso7816),iterations:1});if(a1!=null&&a1.length>0){if(a7(a1)){return a1}}}catch(a6){console.log(a6)}try{var a1=Crypto.AES.decrypt(a5,a4,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:1});if(a1!=null&&a1.length>0){if(a7(a1)){return a1}}}catch(a6){console.log(a6)}if(a3){a3()}return null};this.handleNTPResponse=function(a5,a6){var a3=(new Date()).getTime();if(a5.clientTimeDiff&&a5.serverTime){var a1=a3-a5.serverTime;var a2=(a5.clientTimeDiff-a3+a6-a1)/2;var a4=(a1-a2)/2;if(ad){aR=(aR+a4)/2}else{aR=a4;ad=true;MyStore.put("server_time_offset",""+aR)}console.log("Server Time offset "+aR+"ms - This offset "+a4)}};this.setGUID=function(a3,a1){if(C){throw"Cannot Set GUID Once Initialized"}i.setLoadingText("Downloading Wallet");$("#initial_error,#initial_success").remove();var a2=$("#restore-wallet-continue");a2.prop("disabled",true);var a5=(new Date()).getTime();var a4={format:"json",resend_code:a1,ct:a5};if(aF){a4.checksum=aF}if(e){a4.sharedKey=e}if(U){a4.storageToken=U}$.ajax({type:"GET",dataType:"json",url:root+"wallet/"+a3,data:a4,timeout:60000,success:function(a6){i.handleNTPResponse(a6,a5);a2.prop("disabled",false);if(!a6.guid){i.makeNotice("error","misc-error","Server returned null guid.");return}$(".auth-"+r).hide();af=a6.extra_seed;P=a6.guid;r=a6.auth_type;aU=a6.real_auth_type;A=a6.sync_pubkeys;if(a6.payload&&a6.payload.length>0&&a6.payload!="Not modified"){i.setEncryptedWalletData(a6.payload)}i.sendEvent("did_set_guid");war_checksum=a6.war_checksum;setLocalSymbol(a6.symbol_local);setBTCSymbol(a6.symbol_btc);$("#restore-guid").val(P);$(".auth-"+r).show();if(a6.initial_error){i.makeNotice("error","misc-error",a6.initial_error)}if(a6.initial_success){i.makeNotice("success","misc-success",a6.initial_success)}MyStore.get("guid",function(a7){if(a7!=P){MyStore.remove("guid");MyStore.remove("multiaddr");MyStore.remove("payload");if(P!=F){MyStore.put("guid",P)}}});if(a6.language&&ac!=a6.language){i.setLanguage(a6.language)}},error:function(a6){a2.prop("disabled",false);MyStore.get("guid",function(a7){i.sendEvent("did_fail_set_guid");try{var a9=$.parseJSON(a6.responseText);if(a9.authorization_required){loadScript("wallet/poll-for-session-guid",function(){pollForSessionGUID()})}if(a9.initial_error){i.makeNotice("error","misc-error",a9.initial_error)}return}catch(a8){}if(a6.responseText){i.makeNotice("error","misc-error",a6.responseText)}else{i.makeNotice("error","misc-error","Error changing wallet identifier")}})}})};function j(a1){var a2=B58.encode(a1);return aT(a2)}this.decryptPK=function(a1){if(H){if(aq==null){throw"Cannot decrypt private key without a password"}return i.decrypt(a1,e+aq,i.getSecondPasswordPbkdf2Iterations(),i.isBase58)}else{return a1}return null};this.decodePK=function(a2){if(!a2){throw"null PK passed to decodePK"}var a1=i.decryptPK(a2);if(a1!=null){return B58.decode(a1)}return null};this.signmessage=function(a1,a3){var a5=L[a1];if(!a5.priv){throw"Cannot sign a watch only address"}var a4=i.decodePK(a5.priv);var a2=new Bitcoin.ECKey(a4);return Bitcoin.Message.signMessage(a2,a3,a5.addr)};this.validateSecondPassword=function(a2){var a1=Crypto.SHA256(e+a2,{asBytes:true});var a5=aj(a1,i.getSecondPasswordPbkdf2Iterations()-1);if(a5==x){aq=a2;return true}if(i.getSecondPasswordPbkdf2Iterations()!=10){var a3=aj(a1,10-1);if(a3==x){aq=a2;x=a5;return true}}if(Crypto.util.bytesToHex(a1)==x){aq=a2;x=a5;return true}var a4=Crypto.SHA256(a2);if(a4==x){aq=a2;x=a5;return true}return false};this.runCompressedCheck=function(){var a1=[];var a3={};for(var a4 in L){var a8=L[a4];if(a8.priv!=null){var a7=i.decodePK(a8.priv);var a5=new Bitcoin.ECKey(a7);var a2=a5.getBitcoinAddress().toString();var a6=a5.getBitcoinAddressCompressed().toString();if(a8.addr!=a2){a3[a2]=a8.priv;a1.push(a2)}if(a8.addr!=a6){a3[a6]=a8.priv;a1.push(a6)}}}if(a1.length==0){alert("to_check length == 0")}BlockchainAPI.get_balances(a1,function(bc){var bd=0;for(var bb in bc){var be=bc[bb].final_balance;if(be>0){var ba=new Bitcoin.ECKey(i.decodePK(a3[bb]));var a9=ba.getBitcoinAddress().toString();if(i.addPrivateKey(ba,{compressed:a9!=bb,app_name:IMPORTED_APP_NAME,app_version:IMPORTED_APP_VERSION})){alert(formatBTC(be)+" claimable in address "+bb)}}bd+=be}alert(formatBTC(bd)+" found in compressed addresses");if(bd>0){i.backupWallet("update",function(){i.get_history()})}})};this.checkAllKeys=function(a1){for(var a2 in L){var a6=L[a2];if(a6.addr==null){throw"Null Address Found in wallet "+a2}if(a6.addr.toString()==null){throw"Error decoding wallet address "+a6.addr}if(a6.priv!=null){var a5=i.decodePK(a6.priv);var a4=new Bitcoin.ECKey(a5);var a3=a4.getBitcoinAddress().toString();if(a3!=a6.addr&&a4.getBitcoinAddressCompressed().toString()!=a6.addr){throw"Private key does not match bitcoin address "+a6.addr+" != "+a3}if(a1){a6.priv=j(a5)}}}i.makeNotice("success","wallet-success","Wallet verified.")};this.setMainPassword=function(a1){i.getMainPassword(function(){aO=a1;i.backupWallet("update",function(){i.logout()},function(){i.logout()})})};function al(a1){if(a1===k){return}if(k!=null){if($("#"+k.attr("id")+"-btn").length>0){$("#"+k.attr("id")+"-btn").parent().attr("class","")}k.hide()}k=a1;k.show();if($("#"+k.attr("id")+"-btn").length>0){$("#"+k.attr("id")+"-btn").parent().attr("class","active")}d(true)}function aK(a3){var a2=0,a1;for(a1 in a3){a2++}return a2}function ai(a1){L[a1].priv=null}function ap(){if(aK(L)>=aH){i.makeNotice("error","misc-error","We currently support a maximum of "+aH+" private keys, please remove some unused ones.");return true}return false}function aX(a3,a1){var a2=L[a3];if(!a2||a2.length==0){L[a3]={addr:a3,priv:a1,balance:0};return true}else{if(!a2.priv&&a1){a2.priv=a1;return true}}return false}function p(){var a3=$("#add-address-book-entry-modal");a3.modal({keyboard:true,backdrop:"static",show:true});var a1=a3.find('input[name="label"]');var a2=a3.find('input[name="address"]');a1.val("");a2.val("");a3.find(".btn.btn-primary").unbind().click(function(){a3.modal("hide");var a5=$.trim(a1.val());var a4=$.trim(a2.val());if(a5.length==0||a4.length==0){i.makeNotice("error","misc-error","You must enter an address and label for the address book entry");return false}if(!ak(a5)||!ak(a4)){i.makeNotice("error","misc-error","Label and Bitcoin Address must contain letters and numbers only");return false}var a7;try{a7=new Bitcoin.Address(a4);if(a7==null){throw"Null address"}}catch(a6){i.makeNotice("error","misc-error","Bitcoin address invalid, please make sure you entered it correctly");return false}if(h[a4]!=null){i.makeNotice("error","misc-error","Bitcoin address already exists");return false}i.makeNotice("success","misc-success","Added Address book entry");i.addAddressBookEntry(a4,a5);i.backupWalletDelayed();$("#send-coins").find(".tab-pane").trigger("show",true)});a3.find(".btn.btn-secondary").unbind().click(function(){a3.modal("hide")})}this.logout=function(){if(aw){return}if(P==F){window.location=root+"wallet/logout"}else{$.ajax({type:"GET",timeout:60000,url:root+"wallet/logout",data:{format:"plain"},success:function(a1){window.location.reload()},error:function(){window.location.reload()}})}};function au(a7){var a9=$("#delete-address-modal");a9.modal({keyboard:true,backdrop:"static",show:true});a9.find(".btn.btn-primary").hide();a9.find(".btn.btn-danger").hide();$("#change-mind").hide();a9.find("#to-delete-address").html(a7.join(" "));a9.find("#delete-balance").empty();var a3=a9.find("#delete-balance");var a1=[];for(var a6 in a7){var a8=a7[a6];if(L[a8]&&L[a8].priv){a1.push(a7[a6])}}BlockchainAPI.get_balance(a1,function(ba){a9.find(".btn.btn-primary").show(200);a9.find(".btn.btn-danger").show(200);a3.html("Balance "+formatBTC(ba));if(ba>0){a3.css("color","red")}else{a3.css("color","black")}},function(){a9.find(".btn.btn-primary").show(200);a9.find(".btn.btn-danger").show(200);a3.text("Error Fetching Balance")});var a4=false;var a6=0;var a2=null;var a5=10;changeMind=function(){$("#change-mind").show();$("#change-mind-time").text(a5-a6)};a9.find(".btn.btn-primary").unbind().click(function(){changeMind();a9.find(".btn.btn-primary").hide();a9.find(".btn.btn-danger").hide();a2=setInterval(function(){if(a4){return}++a6;changeMind();if(a6==a5){$("#delete-address-modal").modal("hide");i.makeNotice("warning","warning-deleted","Private Key Removed From Wallet");for(var ba in a7){ai(a7[ba])}d();i.backupWallet();clearInterval(a2)}},1000)});a9.find(".btn.btn-danger").unbind().click(function(){changeMind();a9.find(".btn.btn-primary").hide();a9.find(".btn.btn-danger").hide();a2=setInterval(function(){if(a4){return}++a6;changeMind();if(a6==a5){try{$("#delete-address-modal").modal("hide");i.makeNotice("warning","warning-deleted","Address & Private Key Removed From Wallet");for(var ba in a7){i.deleteAddress(a7[ba])}d();i.backupWallet("update",function(){i.get_history()})}finally{clearInterval(a2)}}},1000)});a9.unbind().on("hidden",function(){if(a2){a4=true;clearInterval(a2);a2=null}});a9.find(".btn.btn-secondary").unbind().click(function(){a9.modal("hide")})}function aG(){var a3=[];for(var a1 in h){a3.push(h[a1])}for(var a1 in L){var a2=L[a1];if(a2.tag!=2&&a2.label){a3.push(a2.label)}}return a3}this.sweepAddressesModal=function(a2,a1){i.getSecondPassword(function(){var a4=$("#sweep-address-modal");a4.modal("show");BlockchainAPI.get_balance(a2,function(a5){a4.find(".balance").text("Amount: "+formatBTC(a5))},function(){a4.find(".balance").text("Error Fetching Balance")});var a3=a4.find('select[name="change"]');m(a3,true);a4.find(".btn.btn-primary").unbind().click(function(){loadScript("wallet/signer",function(){BlockchainAPI.get_balance(a2,function(a6){var a7=initNewTx();var a5=a3.val();if(a5=="any"){a5=i.getPreferredAddress()}a7.fee=a7.base_fee;a7.to_addresses.push({address:new Bitcoin.Address(a5),value:BigInteger.valueOf(a6).subtract(a7.fee)});a7.from_addresses=a2;a7.extra_private_keys=a1;a7.start()},function(){i.makeNotice("error","misc-error","Error Getting Address Balance")})});a4.modal("hide")});a4.find(".btn.btn-secondary").unbind().click(function(){a4.modal("hide")})})};this.openWindow=function(a2){function a1(a5){var a4=false;try{if(typeof a5=="undefined"||!a5){a4=true}else{if(a5&&a5.closed){a4=false}else{if(a5&&a5.test){a4=false}}}}catch(a6){}return a4}var a3=window.open(a2,null,"scroll=1,status=1,location=1,toolbar=1");if(a1(a3)){i.makeNotice("error","misc-error","Popup Blocked. Try and click again.");return false}else{return true}};function aI(){try{$(".pop").popover({offset:10,placement:"bottom"})}catch(a1){}}function o(){if(Y){return}Y=true;$("#add-address-book-entry-btn").click(function(){p()});$("#home-intro-btn").click(function(){al($("#home-intro"))});$("#my-transactions-btn").click(function(){al($("#my-transactions"))});$("#send-coins-btn").click(function(){al($("#send-coins"))});$("#import-export-btn").click(function(){al($("#import-export"));W()});$("#chord-diagram").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Address Relationships",description:"",src:root+"taint/"+i.getActiveAddresses().join("|")})})});$("#verify-message").click(function(){loadScript("wallet/address_modal",function(){verifyMessageModal()})});$("#generate-cold-storage").click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showColdStorageModal()},null,true)});$("#group-received").click(function(){loadScript("wallet/taint_grouping",function(){try{loadTaintData()}catch(a1){i.makeNotice("error","misc-error","Unable To Load Taint Grouping Data")}})});$("#my-account-btn").click(function(){al($("#my-account"));var a1=$("#account-settings-warning").show();var a2=$("#my-account-content").hide();$("#show-account-settings").unbind().click(function(){i.getMainPassword(function(){a1.hide();loadScript("wallet/account",function(){AccountSettings.init(a2,function(){a2.show()},function(){al($("#home-intro"))})},function(a3){i.makeNotice("error","misc-error",a3);al($("#home-intro"))})},function(){al($("#home-intro"))})})});$("#shared-addresses").on("show",function(){var a1=$(this);loadScript("wallet/shared-addresses",function(){buildSharedTable(a1)})});$("#active-addresses").on("show",function(){var a7=$(this).find("table:first");a7.find("tbody:gt(0)").remove();var a4=a7.find("tbody").empty();for(var a6 in L){var a8=L[a6];if(a8.tag==2||a8.tag==1){continue}var a5="";if(a8.tag==1){a5=' <font color="red" class="pop" title="Not Synced" data-content="This is a new address which has not yet been synced with our the server. Do not used this address yet.">(Not Synced)</font>'}else{if(a8.priv==null){a5=' <font color="red" class="pop" title="Watch Only" data-content="Watch Only means there is no private key associated with this bitcoin address. <br /><br /> Unless you have the private key stored elsewhere you do not own the funds at this address and can only observe the transactions.">(Watch Only)</font>'}}var a1="";var a3=a8.addr;if(a8.label!=null){a3=a8.label;a1='<span class="hidden-phone"> - '+a8.addr+"</span>"}var a2=$('<tr><td><div class="short-addr"><a href="'+root+"address/"+a8.addr+'" target="new">'+a3+"</a>"+a1+" "+a5+'<div></td><td><span style="color:green">'+formatMoney(a8.balance,true)+'</span></td>            <td><div class="btn-group pull-right"><a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#"><span class="hidden-phone">Actions </span><span class="caret"></span></a><ul class="dropdown-menu">             <li><a href="#" class="pop act-archive" title="Archive Address" data-content="Click this button to hide the address from the main view. You can restore or delete later by finding it in the Archived addresses tab.">Archive Address</a></li>            <li><a href="#" class="pop act-label" title="Label Address" data-content="Set the label for this address.">Label Address</a></li>            <li><a href="#" class="pop act-qr" title="Show QR Code" data-content="Show a QR Code for this address.">QR Code</a></li>            <li><a href="#" class="pop act-sign" title="Sign Message" data-content="Sign A message with this address.">Sign Message</a></li>            <li><a href="#" class="pop act-request" title="Request Payment" data-content="Click here to create a new QR Code payment request. The QR Code can be scanned using most popular bitcoin software and mobile apps.">Create Payment Request</a></li>            <li><a href="#" class="pop act-pubkey">Show Public Key</a></li>            </ul></div></td></tr>');(function(a9){a2.find(".act-archive").click(function(){i.archiveAddr(a9)});a2.find(".act-label").click(function(){loadScript("wallet/address_modal",function(){showLabelAddressModal(a9)})});a2.find(".act-qr").click(function(){loadScript("wallet/address_modal",function(){showAddressModalQRCode(a9)})});a2.find(".act-pubkey").click(function(){i.getSecondPassword(function(){var ba=i.getPrivateKey(a9);if(ba==null){i.makeNotice("eror","misc-error","Public Key Unknown");return}var bb=new Bitcoin.ECKey(i.decodePK(ba));if(bb.getBitcoinAddressCompressed().toString()==a9){var bc=bb.getPubCompressed()}else{var bc=bb.getPub()}i.makeNotice("success","pub-key","Public Key of "+a9+" is "+Crypto.util.bytesToHex(bc),20000)})});a2.find(".act-sign").click(function(){loadScript("wallet/address_modal",function(){showAddressModalSignMessage(a9)})});a2.find(".act-request").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Create Payment Request",description:"Request Payment into address <b>"+a9+"</b>",src:root+"payment_request?address="+a9})})})})(a8.addr);if(a8.balance>0&&a8.priv){a7.prepend(a2)}else{a7.append(a2)}}aI()});$("#archived-addresses").on("show",function(){$("#archived-addr tbody").empty();var a2=$(this).find("tbody");var a1=i.getArchivedAddresses();var a3=function(){a2.empty();for(var a7 in a1){var a9=L[a1[a7]];if(a9.tag!=2||a9.tag==1){continue}var a6="";if(a9.priv==null){a6=' <font color="red">(Watch Only)</font>'}var a4="";var a5=a9.addr;if(a9.label!=null){a5=a9.label;a4='<span class="hidden-phone"> - '+a9.addr+"</span>"}var a8=$('<tr><td style="width:20px;"><input type="checkbox" class="archived_checkbox" value="'+a9.addr+'"></td><td><div class="short-addr"><a href="'+root+"address/"+a9.addr+'" target="new">'+a5+"</a>"+a4+" "+a6+'<div></td><td><span style="color:green">'+formatBTC(a9.balance)+'</span></td><td style="width:16px"><img src="'+resource+'unarchive.png" class="act-unarchive" /></td></tr>');(function(ba){a8.find(".act-unarchive").click(function(){i.unArchiveAddr(ba)})})(a9.addr);if(a9.balance>0&&a9.priv){a2.prepend(a8)}else{a2.append(a8)}}};a3();BlockchainAPI.get_balances(a1,function(a4){a3()},function(a4){i.makeNotice("error","misc-error",a4)})});$("#archived-select-all").click(function(){$(".archived_checkbox").prop("checked",true)});$("#archived-select-none").click(function(){$(".archived_checkbox").prop("checked",false)});$("#archived-sweep").click(function(){var a1=[];$(".archived_checkbox:checked").each(function(){var a2=L[$(this).val()];if(a2.priv==null){i.makeNotice("error","misc-error","Cannot Sweep Watch Only Address");return}a1.push(a2.addr)});if(a1.length==0){return}i.sweepAddressesModal(a1)});$("#archived-delete").click(function(){var a1=[];$(".archived_checkbox:checked").each(function(){a1.push($(this).val())});if(a1.length==0){return}au(a1)});$("#shared-never-ask").click(function(){SetCookie("shared-never-ask",$(this).is(":checked"))});$(".deposit-btn").click(function(){var a3=$(this);var a2=i.getPreferredAddress();var a1=a3.data("extra");if(a1==null){a1=""}loadScript("wallet/frame-modal",function(){showFrameModal({title:a3.data("title"),description:"Deposit into address <b>"+a2+"</b>",top_right:'Have Questions? Read <a href="'+a3.data("link")+'" target="new">How It Works</a>',src:root+"deposit?address="+a2+"&ptype="+a3.data("type")+"&guid="+P+a1})})});$(".withdraw-btn").click(function(){var a1=$(this);i.getSecondPassword(function(){var a2=i.getPreferredAddress();loadScript("wallet/frame-modal",function(){showFrameModal({title:a1.data("title"),description:"Your Wallet Balance is <b>"+formatBTC(aE)+"</b>",src:root+"withdraw?method="+a1.data("type")+"&address="+a2+"&balance="+aE+"&guid="+P})})})});$("#logout").click(i.logout);$("#refresh").click(function(){M(function(){i.get_history()})});$("#summary-n-tx-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Number of transactions",description:"",src:root+"charts/n-transactions?show_header=false&address="+i.getActiveAddresses().join("|")})})});$("#summary-received-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"BTC Received Per Day",description:"",src:root+"charts/received-per-day?show_header=false&address="+i.getActiveAddresses().join("|")})})});$("#summary-balance-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Wallet Balance",description:"",src:root+"charts/balance?show_header=false&address="+i.getActiveAddresses().join("|")})})});$("#new-addr").click(function(){M(function(){i.getSecondPassword(function(){var a2=i.generateNewKey();var a1=a2.getBitcoinAddress().toString();i.backupWallet("update",function(){i.makeNotice("info","new-address","Generated new Bitcoin Address "+a1);loadScript("wallet/address_modal",function(){showLabelAddressModal(a1)});i.get_history()})},function(){i.logout()})})});$(".tx_filter a").click(function(){aC=0;ax=$(this).data("value");i.get_history()});$(".tx_display a").click(function(){var a1=$(this).data("value");if(a1=="export"){w();return}t.tx_display=a1;d();i.backupWalletDelayed()});$("#email-backup-btn").click(function(){I()});$("#dropbox-backup-btn").click(function(){i.openWindow(root+"wallet/dropbox-login?guid="+P)});$("#gdrive-backup-btn").click(function(){i.openWindow(root+"wallet/gdrive-login?guid="+P)});$("#balance").click(function(){toggleSymbol();d()});$("#send-quick").on("show",function(a3,a2){var a1=$(this);s(a1,a2);a1.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(a1,"quick",initNewTx())})})});$("#send-email").on("show",function(a3,a2){var a1=$(this);s(a1,a2);a1.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(a1,"email",initNewTx())})})});$("#send-shared").on("show",function(a3,a2){var a1=$(this);s(a1,a2);a1.find(".mixer_fee").text(y);a1.find(".fees,.free,.bonus").show();if(y<0){a1.find(".fees,.free").hide()}else{if(y==0){a1.find(".fees,.bonus").hide()}else{a1.find(".free,.bonus").hide()}}a1.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(a1,"shared",initNewTx())})});a1.find(".shared-fees").text("0.00");a1.find('input[name="send-before-fees"]').unbind().bind("keyup change",function(){var a5=parseFloat($(this).val());var a4=0;if(a5>0){if(y>0){a4=parseFloat(a5+((a5/100)*y))}else{a4=parseFloat(a5);a1.find(".bonus-value").text(formatPrecision((Math.min(a5,precisionFromBTC(200))/100)*y))}}if(precisionToBTC(a5)<0.1||precisionToBTC(a5)>250){a1.find(".shared-fees").text("0.00");a1.find(".send").prop("disabled",true)}else{a1.find(".shared-fees").text(formatBTC(a4*symbol_btc.conversion));a1.find(".send").prop("disabled",false)}a1.find(".send-value").val(a4).trigger("keyup")})});$("#send-custom").on("show",function(a3,a2){var a1=$(this);s(a1,a2);a1.find(".send").unbind().click(function(){var a4=false;if(a1.find('textarea[name="public-note"]').val()){a1.find(".send-value").each(function(){if($(this).val()<0.0001){i.makeNotice("error","misc-error","You cannot attach a note to a transaction with an output size less than 0.0001 BTC");a4=true;return false}})}if(!a4){loadScript("wallet/signer",function(){startTxUI(a1,"custom",initNewTx())})}});a1.find('input[name="fees"]').unbind().bind("keyup change",function(a4){if(a4.keyCode=="9"){return}$(this).parent().find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});a1.find(".reset").unbind().click(function(){s(a1,true);a1.find('select[name="from"]').trigger("change")})});$("#shared-coin").on("show",function(a3,a2){var a1=$(this);loadScript("wallet/sharedcoin",function(){try{s(a1);SharedCoin.init(a1)}catch(a4){console.log(a4);i.makeNotice("error","misc-error",a4)}},function(a4){i.makeNotice("error","misc-error",a4)})});$("#send-sms").on("show",function(a3,a2){if(a2){return}var a1=$(this);s(a1);$.ajax({type:"GET",timeout:60000,url:resource+"wallet/country_codes.html",success:function(a4){a1.find('select[name="sms-country-code"]').html(a4)},error:function(){i.makeNotice("error","misc-error","Error Downloading SMS Country Codes")}});a1.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){var a4=initNewTx();startTxUI(a1,"sms",a4)})})});$("#address-book").on("show",function(){var a2=$("#address-book-tbl tbody");if(aK(h)>0){a2.empty();for(var a1 in h){var a3=$("<tr><td>"+h[a1]+'</td><td><div class="addr-book-entry">'+a1+'</div></td><td style="width:16px" class="hidden-phone"><img src="'+resource+'delete.png" class="act-delete" /></td></tr>');(function(a4){a3.find(".act-delete").click(function(){i.deleteAddressBook(a4)})})(a1);a2.append(a3)}}});$('a[data-toggle="tab"]').unbind().on("show",function(a1){$(a1.target.hash).trigger("show")});$("#receive-coins-btn").click(function(){al($("#receive-coins"))});$("#cash-into-coins").click(function(){$(this).attr("href",$(this).attr("href")+i.getPreferredAddress())});$(".show_adv").click(function(){$(".modal:visible").center()});$(".download-backup-btn").show();aI()}function q(){$(".resend-code").click(function(){i.setGUID(P,true)});$("#reset-two-factor-btn").click(function(){i.openWindow(root+"wallet/reset-two-factor"+(P?"?guid="+P:""))});$(".recover-wallet-btn").click(function(){i.openWindow(root+"wallet/forgot-password"+(P?"?guid="+P:""))});$(".download-backup-btn").toggle(ao!=null).click(function(){if(!ao){i.makeNotice("error","error","No Wallet Data to Download");return}try{var a2=!!new Blob()}catch(a3){}if(a2){loadScript("wallet/filesaver",function(){var a4=new Blob([ao],{type:"text/plain;charset=utf-8"});saveAs(a4,"wallet.aes.json")})}else{var a1=window.open(null,null,"width=700,height=800,toolbar=0");a1.document.write('<!DOCTYPE html><html><head></head><body><div style="word-wrap:break-word;" >'+ao+"</div></body></html>")}aY()});$(".auth-0,.auth-1,.auth-2,.auth-3,.auth-4,.auth-5").unbind().keypress(function(a1){if(a1.keyCode==13){a1.preventDefault();$("#restore-wallet-continue").click()}});$("#restore-wallet-continue").unbind().click(function(a2){a2.preventDefault();var a1=$.trim($("#restore-guid").val());if(a1.length==0){return}if(P!=a1){e=null;i.setGUID(a1,false)}else{b()}});$(".modal").on("show",function(){O();$(this).center()}).on("hidden",function(){var a2=$(".modal:visible");var a1=$("#notices").remove();if(a2.length>0){a2.find(".modal-body").prepend(a1)}else{$("#main-notices-container").append(a1)}}).on("shown",function(){O();var a1=$(this);setTimeout(function(){if(a1.is(":visible")){a1.find(".modal-body").prepend($("#notices").remove())}},100);a1.center()})}function ar(a2){var a3=Crypto.SHA256(a2+"?");switch(a3.slice(0,2)){case"00":var a4=Crypto.SHA256(a2,{asBytes:true});return a4;break;case"01":var a1=Crypto.util.hexToBytes(a3.slice(2,4))[0];var a5=Math.round(Math.pow(2,(a1/4)));var a4=Crypto.PBKDF2(a2,"Satoshi Nakamoto",32,{iterations:a5,asBytes:true});return a4;break;default:console.log("invalid key");break}}function aN(){var a3,a1="";if(window.getSelection){a3=window.getSelection();if(a3.rangeCount){var a4=a3.getRangeAt(0).cloneContents();var a2=document.createElement("div");a2.appendChild(a4);a1=a2.innerText}}else{if(document.selection&&document.selection.type=="Text"){a1=document.selection.createRange().htmlText}}return a1}this.detectPrivateKeyFormat=function(a2){if(/^5[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(a2)){return"sipa"}if(/^[LK][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(a2)){return"compsipa"}if(/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{44}$/.test(a2)||/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{43}$/.test(a2)){return"base58"}if(/^[A-Fa-f0-9]{64}$/.test(a2)){return"hex"}if(/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(a2)){return"base64"}if(/^6P[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{56}$/.test(a2)){return"bip38"}if(/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(a2)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(a2)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(a2)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{30}$/.test(a2)){var a1=Crypto.SHA256(a2+"?",{asBytes:true});if(a1[0]===0||a1[0]===1){return"mini"}}throw"Unknown Key Format "+a2};this.privateKeyStringToKey=function(a2,a4){var a1=null;if(a4=="base58"){a1=B58.decode(a2)}else{if(a4=="base64"){a1=Crypto.util.base64ToBytes(a2)}else{if(a4=="hex"){a1=Crypto.util.hexToBytes(a2)}else{if(a4=="mini"){a1=ar(a2)}else{if(a4=="sipa"){var a3=B58.decode(a2);a3.shift();a1=a3.slice(0,a3.length-4)}else{if(a4=="compsipa"){var a3=B58.decode(a2);a3.shift();a3.pop();a1=a3.slice(0,a3.length-4)}else{throw"Unsupported Key Format"}}}}}}if(a1.length!=32){throw"Result not 32 bytes in length"}return new Bitcoin.ECKey(a1)};$(document).ready(function(){if(!$.isEmptyObject({})||!$.isEmptyObject([])){i.makeNotice("error","error","Object.prototype has been extended by a browser extension. Please disable this extensions and reload the page.");return}$("input,button,select").attr("autocomplete","off");aP();var a2=$(document.body);P=a2.data("guid");e=a2.data("sharedkey");ac=a2.data("language");if(i.skip_init){return}MyStore.get("storage_token",function(a8){U=a8});MyStore.get("server_time_offset",function(a8){aR=parseInt(a8);if(isNaN(aR)){aR=0}});q();var a3=$("#restore-guid").val();if(P&&P.length==36){i.setGUID(P,false)}else{if(a3&&a3.length>0){$("#restore-wallet-continue").click()}else{if(isExtension||window.location.href.indexOf("/login")>0){MyStore.get("guid",function(a8){if(a8&&a8.length==36){i.setGUID(a8,false)}else{$("#signup-btn").show()}})}else{$("#signup-btn").show()}}}if(top.location!=self.location){top.location=self.location.href}a2.click(function(){if(Z){clearTimeout(Z);Z=setTimeout(i.logout,i.getLogoutTime())}rng_seed_time()}).keypress(function(){if(Z){clearTimeout(Z);Z=setTimeout(i.logout,i.getLogoutTime())}rng_seed_time()}).mousemove(function(a8){if(a8){rng_seed_int(a8.clientX*a8.clientY)}});$(".auth-"+r).show();k=$("#restore-wallet");k.show();var a4=false;var a7=17,a6=86,a1=67,a5=67;$(document).keydown(function(a9){try{if(a9.keyCode==a7||a9.keyCode==a5){a4=true}if(a4&&a9.keyCode==a1){var a8=$.trim(aN());var ba=L[a8];if(ba!=null){if(ba.priv==null){$("#watch-only-copy-warning-modal").modal("show")}}}}catch(a9){console.log(a9)}}).keyup(function(a8){if(a8.keyCode==a7||a8.keyCode==a5){a4=false}}).ajaxStart(function(){az("loading_start");$(".loading-indicator").fadeIn(200)}).ajaxStop(function(){az("loading_stop");$(".loading-indicator").hide()})});function a0(){$("#receive-coins").find(".tab-pane.active").trigger("show");setupToggle()}};