function precisionToSatoshiBN(a){return Bitcoin.Util.parseValue(a).divide(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)).toString()))}function precisionToBTC(a){return Bitcoin.Util.formatValue(precisionToSatoshiBN(a))}function precisionFromBTC(a){return Bitcoin.Util.formatValue(Bitcoin.Util.parseValue(a).multiply(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)))))}function formatPrecision(a){return formatBTC(precisionToSatoshiBN(a).toString())}var MyWallet=new function(){var h=this;this.skip_init=false;var D="abcaa314-6f67-6705-b384-5d47fbe9d7cc";var ai;var M;var j;var aG;var ak;var w;var d;var ax=0;var S=0;var ar=0;var K=0;var aR=0;var aE;var g={};var E=[];var F=false;var av=0;var aq=0;var aA=1000;var I={};var ay;var am;var x=0.5;var af=10;var P=af;var b={};var q;var aM=0;var U;var Y=[];var B;var N=60000;var A=false;var Z;var ap=false;var X="en";var ao=2;var Q=0;var aJ=0;var s={pbkdf2_iterations:af,fee_policy:0,html5_notifications:false,logout_time:600000,tx_display:0,always_keep_local_backup:false};this.setEncryptedWalletData=function(aT){if(!aT||aT.length==0){ai=null;ay=null;return}ai=aT;ay=ag();try{if(aM==0||s.always_keep_local_backup){MyStore.put("payload",ai)}}catch(aU){console.log(aU)}};this.setRealAuthType=function(aT){aM=aT};this.getLanguage=function(){return X};this.addEventListener=function(aT){Y.push(aT)};this.getLogoutTime=function(){return s.logout_time};this.getSecondPasswordPbkdf2Iterations=function(){return s.pbkdf2_iterations};this.getMainPasswordPbkdf2Iterations=function(){return P};this.getDefaultPbkdf2Iterations=function(){return af};this.setLogoutTime=function(aT){s.logout_time=aT;clearInterval(U);U=setTimeout(h.logout,h.getLogoutTime())};this.getDoubleEncryption=function(){return F};this.getEncryptedWalletData=function(){return ai};this.getFeePolicy=function(){return s.fee_policy};this.setFeePolicy=function(aT){s.fee_policy=parseInt(aT)};this.setAlwaysKeepLocalBackup=function(aT){s.always_keep_local_backup=aT};this.getAlwaysKeepLocalBackup=function(){return s.always_keep_local_backup};this.getGuid=function(){return M};this.getHTML5Notifications=function(){return s.html5_notifications};this.setHTML5Notifications=function(aT){s.html5_notifications=aT};this.getTransactions=function(){return E};this.addressExists=function(aT){return I[aT]!=null};this.getAddressTag=function(aT){return I[aT].tag};this.setAddressTag=function(aU,aT){I[aU].tag=aT};this.getAddressBook=function(){return g};this.getAddressLabel=function(aT){return I[aT].label};this.setAddressLabel=function(aT,aU){I[aT].label=aU};this.setAddressBalance=function(aT,aU){I[aT].balance=aU};this.getAddressBookLabel=function(aT){return g[aT]};this.isWatchOnly=function(aT){return !I[aT]||I[aT].priv==null};this.getAddressBalance=function(aT){return I[aT].balance};this.getMixerFee=function(){return x};this.deleteAddress=function(aT){delete I[aT]};this.addAddressBookEntry=function(aU,aT){g[aU]=aT};this.getPrivateKey=function(aT){return I[aT].priv};this.setLabel=function(aT,aU){I[aT].label=aU;ah();c()};this.securePost=function(aT,aU,a2,aZ){var aY=jQuery.extend({},aU);if(!aU.sharedKey){if(!d||d.length==0||d.length!=36){throw"Shared key is invalid"}var aX=parseInt((new Date().getTime()-aJ)/10000);var aW=Crypto.SHA256(d.toLowerCase()+aX);var aV=0;var a1=aW.substring(aV,aV+=8)+"-"+aW.substring(aV,aV+=4)+"-"+aW.substring(aV,aV+=4)+"-"+aW.substring(aV,aV+=4)+"-"+aW.substring(aV,aV+=12);aY.sharedKey=a1}if(!aU.guid){aY.guid=M}aY.format=aU.format?aU.format:"plain";var a0="text";if(aU.format=="json"){a0="json"}$.ajax({dataType:a0,type:"POST",url:root+aT,data:aY,success:a2,error:aZ})};this.isCorrectMainPassword=function(aT){return aG==aT};function ad(aU,aW){var aT=Crypto.SHA256(aU,{asBytes:true});for(var aV=1;aV<aW;++aV){aT=Crypto.SHA256(aT,{asBytes:true})}return Crypto.util.bytesToHex(aT)}this.setPbkdf2Iterations=function(aT,aV){var aU=function(aW){console.log("Panic "+aW);window.location.reload()};h.getSecondPassword(function(){try{if(F){for(var aW in I){var aY=I[aW];if(aY.priv){aY.priv=h.encrypt(h.decryptPK(aY.priv),d+ak,aT);if(!aY.priv){throw"addr.priv is null"}}}s.pbkdf2_iterations=aT;w=ad(d+ak,aT)}Q=2;P=aT;h.backupWallet("update",function(){aV()},function(){aU(aX)})}catch(aX){aU(aX)}},function(aW){aU(aW)})};this.setDoubleEncryption=function(aV,aT,aX){var aU=function(aY){console.log("Panic "+aY);window.location.reload()};try{if(F==aV){return}if(aV){h.getSecondPassword(function(){try{F=true;ak=aT;for(var aY in I){var a0=I[aY];if(a0.priv){a0.priv=i(B58.decode(a0.priv));if(!a0.priv){throw"addr.priv is null"}}}w=ad(d+ak,s.pbkdf2_iterations);ak=null;h.getSecondPassword(function(){try{h.checkAllKeys();h.backupWallet("update",function(){aX()},function(){aU(a1)})}catch(a1){aU(a1)}},function(a1){aU(a1)})}catch(aZ){aU(aZ)}},function(aY){aU(aY)})}else{h.getSecondPassword(function(){try{for(var aY in I){var a0=I[aY];if(a0.priv){a0.priv=h.decryptPK(a0.priv);if(!a0.priv){throw"addr.priv is null"}}}F=false;ak=null;h.checkAllKeys();h.backupWallet("update",function(){aX()},function(){aU(aZ)})}catch(aZ){aU(aZ)}},function(aY){aU(aY)})}}catch(aW){aU(aW)}};this.unArchiveAddr=function(aT){var aT=I[aT];if(aT.tag==2){aT.tag=null;c();ah("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Unarchive This Address")}};this.archiveAddr=function(aT){if(h.getActiveAddresses().length<=1){h.makeNotice("error","add-error","You must leave at least one active address");return}var aT=I[aT];if(aT.tag==null||aT.tag==0){aT.tag=2;c();ah("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Archive This Address")}};this.addWatchOnlyAddress=function(aT){return aP(aT)};this.addPrivateKey=function(aT,aV){if(aj()){return false}if(aT==null){throw"Cannot add null key."}if(aV==null){aV={}}var aY=aV.compressed?aT.getBitcoinAddressCompressed().toString():aT.getBitcoinAddress().toString();var aX=i(aT.priv);if(aX==null){throw"Error Encoding key"}var aU=new Bitcoin.ECKey(h.decodePK(aX));if(aY!=aU.getBitcoinAddress().toString()&&aY!=aU.getBitcoinAddressCompressed().toString()){throw"Decoded Key address does not match generated address"}if(aP(aY,aX)){I[aY].tag=1;I[aY].created_time=aV.created_time?aV.created_time:0;I[aY].created_device_name=aV.app_name?aV.app_name:APP_NAME;I[aY].created_device_version=aV.app_version?aV.app_version:APP_VERSION;if(I[aY].priv!=aX){throw"Address priv does not match encoded"}try{ws.send('{"op":"addr_sub", "addr":"'+aY+'"}')}catch(aW){}}else{throw"Unable to add generated bitcoin address."}return aY};this._seed=function(aV){rng_seed_time();if(aG||aV){var aT=Crypto.util.bytesToWords(Crypto.SHA256(aG?aG:aV,{asBytes:true}));for(var aU in aT){rng_seed_int(aT[aU])}}if(!Z){Z=$("body").data("extra-seed")}if(Z){var aT=Crypto.util.bytesToWords(Crypto.util.hexToBytes(Z));for(var aU in aT){rng_seed_int(aT[aU])}}};this.generateNewKey=function(aU){h._seed(aU);var aT=new Bitcoin.ECKey(false);if(h.addPrivateKey(aT)){return aT}};this.setLoadingText=function(aT){$(".loading-text").text(aT)};function L(){try{$(".popover").remove()}catch(aT){}}$(window).resize(function(){$(".modal:visible").center();L()});function aO(aU,aT){aU.click(function(){z(aT.txIndex,aT.result)});aU.find(".show-note").mouseover(function(){var aV=aT.note?aT.note:b[aT.hash];aI(this,aV,aT.hash)});aU.find(".add-note").mouseover(function(){m(this,aT.hash)});return aU}function t(aU,a0){var aT=0;for(var aW=0;aW<aU.inputs.length;++aW){var aV=aU.inputs[aW].prev_out;if(!aV||!aV.addr){continue}var aZ=I[aV.addr];if(aZ){var aY=parseInt(aV.value);aT-=aY;if(a0){S+=aY;aZ.balance-=aY}}}for(var aX=0;aX<aU.out.length;++aX){var aV=aU.out[aX];if(!aV||!aV.addr){continue}var aZ=I[aV.addr];if(aZ){var aY=parseInt(aV.value);aT+=aY;if(a0){ar+=aY;aZ.balance+=aY}}}return aT}function ag(){return Crypto.util.bytesToHex(Crypto.SHA256(ai,{asBytes:true}))}function y(aT){var aU=null;aT.onmessage=function(a1){try{var aY=$.parseJSON(a1.data);if(aY.op=="on_change"){var a2=ag();var a0=aY.checksum;console.log("On change old "+a2+" ==  new "+a0);if(aU!=a0&&a2!=a0){aU=a0;J()}}else{if(aY.op=="utx"){var aZ=TransactionFromJSON(aY.x);for(var a4 in E){if(E[a4].txIndex==aZ.txIndex){return}}var a6=t(aZ,true);if(h.getHTML5Notifications()){h.showNotification({title:a6>0?"Payment Received":"Payment Sent",body:"Transaction Value "+formatBTC(a6),iconUrl:resource+"cube48.png"})}aZ.result=a6;ax+=a6;K++;aZ.setConfirmations(0);playSound("beep");if(aq==0&&av==0){E.unshift(aZ);var a3=false;if(E.length>50){E.pop();a3=true}}var aW=V();if("my-transactions"==aW){if(aq==0&&av==0){$("#no-transactions").hide();if(s.tx_display==0){var aV=$("#transactions-compact").show();aO($(C(aZ,I,g)),aZ).prependTo(aV.find("tbody")).find("div").hide().slideDown("slow");if(a3){aV.find("tbody tr:last-child").remove()}}else{var aV=$("#transactions-detailed").show();aV.prepend(aZ.getHTML(I,g));if(a3){aV.find("div:last-child").remove()}setupSymbolToggle()}}}else{c()}}else{if(aY.op=="block"){for(var aX=0;aX<aY.x.txIndexes.length;++aX){for(var a5=0;a5<E.length;++a5){if(E[a5].txIndex==aY.x.txIndexes[aX]){if(E[a5].blockHeight==null||E[a5].blockHeight==0){E[a5].blockHeight=aY.x.height;break}}}}aw(BlockFromJSON(aY.x));W()}}}}catch(a1){console.log(a1);console.log(a1.data)}};aT.onopen=function(){at("ok");var aY='{"op":"blocks_sub"}';if(M!=null){aY+='{"op":"wallet_sub","guid":"'+M+'"}'}try{var aW=h.getActiveAddresses();for(var aV in aW){aY+='{"op":"addr_sub", "addr":"'+aW[aV]+'"}'}}catch(aX){alert(aX)}aT.send(aY)};aT.onclose=function(){at("error")}}var aN="ok";function at(aU){var aT=$("#logout");if(aU=="loading_start"){aT.attr("src",resource+"logout-orange.png");return}else{if(aU!="loading_stop"){aN=aU}}if(aN=="ok"){aT.attr("src",resource+"logout.png")}else{if(aN=="error"){aT.attr("src",resource+"logout-red.png")}}}this.showNotification=function(aT){try{if(window.webkitNotifications&&navigator.userAgent.indexOf("Chrome")>-1){if(webkitNotifications.checkPermission()==0){webkitNotifications.createNotification(aT.iconUrl,aT.title,aT.body).show()}}else{if(window.Notification){if(Notification.permissionLevel()=="granted"){new Notification(aT.title,aT).show()}}}}catch(aU){}};this.makeNotice=function(aU,aX,aW,aV){if(aW==null||aW.length==0){return}console.log(aW);if(aV==null){aV=5000}var aT=$('<div class="alert alert-block alert-'+aU+'"></div>');aT.text(""+aW);if($("#"+aX).length>0){aT.attr("id",aX);return}$("#notices").append(aT).hide().fadeIn(200);if(aV>0){(function(){var aY=aT;setTimeout(function(){aY.fadeOut(250,function(){$(this).remove()})},aV)})()}};this.pkBytesToSipa=function(aT,aX){var aU=new Bitcoin.ECKey(aT);while(aT.length<32){aT.unshift(0)}aT.unshift(128);if(aU.getBitcoinAddress().toString()==aX){}else{if(aU.getBitcoinAddressCompressed().toString()==aX){aT.push(1)}else{throw"Private Key does not match bitcoin address"+aX}}var aV=Crypto.SHA256(Crypto.SHA256(aT,{asBytes:true}),{asBytes:true});aT=aT.concat(aV.slice(0,4));var aW=B58.encode(aT);return aW};function aD(aT){return aT}function au(aT){return h.decryptPK(aT)}function ab(aT){var aU=h.decodePK(aT);return Crypto.util.bytesToBase64(aU)}function k(aT){var aU=h.decodePK(aT);return Crypto.util.bytesToHex(aU)}this.base58ToSipa=function(aT,aU){return h.pkBytesToSipa(h.decodePK(aT),aU)};this.makeWalletJSON=function(aT){return h.makeCustomWalletJSON(aT,M,d)};this.makeCustomWalletJSON=function(aY,aU,a0){var aX=aD;if(aY=="base64"){aX=ab}else{if(aY=="hex"){aX=k}else{if(aY=="sipa"){aX=h.base58ToSipa}else{if(aY=="base58"){aX=au}}}}var aT='{\n	"guid" : "'+aU+'",\n	"sharedKey" : "'+a0+'",\n';if(F&&w!=null&&aX==aD){aT+='	"double_encryption" : '+F+',\n	"dpasswordhash" : "'+w+'",\n'}if(s){aT+='	"options" : '+JSON.stringify(s)+",\n"}aT+='	"keys" : [\n';for(var aW in I){var aZ=$.extend({},I[aW]);if(aZ.tag==1){delete aZ.tag}if(aZ.priv!=null){aZ.priv=aX(aZ.priv,aZ.addr)}for(var aV in aZ){if(aZ[aV]===null||aZ[aV]===undefined){delete aZ[aV]}}delete aZ.balance;aT+=JSON.stringify(aZ)+",\n";atLeastOne=true}if(atLeastOne){aT=aT.substring(0,aT.length-2)}aT+="\n	]";if(aC(g)>0){aT+=',\n	"address_book" : [\n';for(var aW in g){aT+='	{"addr" : "'+aW+'",\n';aT+='	 "label" : "'+g[aW]+'"},\n'}aT=aT.substring(0,aT.length-2);aT+="\n	]"}if(aC(b)>0){aT+=',\n	"tx_notes" : '+JSON.stringify(b)}aT+="\n}";return aT};this.get_history=function(aU,aT){BlockchainAPI.get_history(function(aV){H(aV,false);c();if(aU){aU()}},function(){if(aT){aT()}},aq,av)};this.deleteAddressBook=function(aT){delete g[aT];ah();$("#send-coins").find(".tab-pane").trigger("show",true)};function u(aT){$("#send-coins").find(".tab-pane.active").trigger("show",aT);if(aT){BlockchainAPI.get_ticker();$(".send").prop("disabled",false)}}function l(aT,aU,aY){var aX=aT.val();aT.empty();for(var aW in I){var aZ=I[aW];if(!aZ||aZ.tag==2){continue}var aV=aZ.label;if(!aV){aV=aZ.addr.substring(0,15)+"..."}if(aU||aZ.balance>0){aT.prepend('<option value="'+aZ.addr+'">'+aV+" - "+formatBTC(aZ.balance)+"</option>")}}aT.prepend('<option value="any" selected>Any Address</option>');if(!aY&&aX){aT.val(aX)}}function r(aV,aW){l(aV.find('select[name="from"]'),false,aW);l(aV.find('select[name="change"]'),true,aW);aV.find('select[name="change"]').prepend('<option value="new">New Address</option>');aV.find(".local-symbol").text(symbol_local.symbol);aV.find(".btc-symbol").text(symbol_btc.symbol);if(aW){aV.find("input").val("");aV.find(".send-value-usd").text(formatSymbol(0,symbol_local)).val("");aV.find(".amount-needed").text(0)}var aU=aV.find(".recipient-container");if(aW){var aY=aU.find(".recipient:first-child").clone();aU.empty().append(aY)}function aT(){var aZ=BigInteger.ZERO;aV.find('input[name="send-value"]').each(function(){aZ=aZ.add(precisionToSatoshiBN($(this).val()))});return aZ}function aX(aZ){aZ.find('input[name="send-to-address"]').typeahead({source:az()}).next().click(function(){var a0=$(this).prev();h.scanQRCode(function(a1){console.log(a1);try{new Bitcoin.Address(a1);a0.val(a1)}catch(a2){h.handleURI(a1,aZ)}},function(a1){h.makeNotice("error","misc-error",a1)})});aZ.find('input[name="send-value"]').unbind().bind("keyup change",function(a0){if(a0.keyCode=="9"){return}aV.find(".amount-needed").text(formatBTC(aT().toString()));aZ.find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});aZ.find(".send-value-usd").text(formatSymbol(0,symbol_local)).unbind().bind("keyup change",function(a0){if(a0.keyCode=="9"){return}aZ.find('input[name="send-value"]').val(formatSatoshi(parseFloat($(this).val())*symbol_local.conversion,sShift(symbol_btc),true))})}aU.find(".recipient").each(function(){aX($(this))});aV.find(".remove-recipient").unbind().click(function(){var aZ=aU.find(".recipient").length;if(aZ>1){if(aZ==2){$(this).hide(200)}aU.find(".recipient:last-child").remove()}});aV.find(".add-recipient").unbind().click(function(){var aZ=aU.find(".recipient:first-child").clone();aZ.appendTo(aU);aX(aZ);aV.find(".remove-recipient").show(200)})}this.getAllAddresses=function(){var aU=[];for(var aT in I){aU.push(aT)}return aU};this.getPreferredAddress=function(){var aU=null;for(var aT in I){var aV=I[aT];if(aU==null){aU=aV}if(aV.priv!=null){if(aU==null){aU=aV}if(aV.tag==null||aV.tag==0){aU=aV;break}}}return aU.addr};function aQ(){var aT=$("#restore-backup-modal");aT.modal({keyboard:true,backdrop:"static",show:true});aT.find(".btn.btn-secondary").unbind().click(function(){aT.modal("hide")})}this.scanQRCode=function(aV,aT){var aU=$("#qr-code-reader-modal");aU.modal({keyboard:false,backdrop:"static",show:true});loadScript("wallet/qr.code.reader",function(){QRCodeReader.init(aU,function(aW){aU.modal("hide");aV(aW)},function(aW){aU.modal("hide");aT(aW)})},aT);aU.find(".btn.btn-secondary").unbind().click(function(){QRCodeReader.stop();aU.modal("hide");aT()})};this.getActiveAddresses=function(){var aV=[];for(var aT in I){var aU=I[aT];if(aU.tag!=2){aV.push(aU.addr)}}return aV};this.getArchivedAddresses=function(){var aV=[];for(var aT in I){var aU=I[aT];if(aU.tag==2){aV.push(aU.addr)}}return aV};function aw(aW){if(aW!=null){aE=aW;for(var aU in E){var aT=E[aU];if(aT.blockHeight!=null&&aT.blockHeight>0){var aV=aE.height-aT.blockHeight+1;if(aV<=100){aT.setConfirmations(aE.height-aT.blockHeight+1)}else{aT.setConfirmations(null)}}else{aT.setConfirmations(0)}}}}function z(aU,aT){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Transaction Summary",description:"",src:root+"tx-summary/"+aU+"?result="+aT+"&guid="+M})})}this.deleteNote=function(aT){delete b[aT];c();ah()};function m(aT,aU){(function(aW,aY){aW=$(aW);if(!aW.data("popover")){aW.popover({title:'Add Note <span style="float:right"><i class="icon-remove-sign"></i></span>',trigger:"manual",content:'<textarea style="width:97%;height:50px;margin-top:2px" placeholder="Enter the note here..."></textarea><div style="text-align:right"><button class="btn btn-small">Save</button></div>'})}else{if(aW.data("popover").tip().is(":visible")){return}}aW.popover("show");aW.mouseleave(function(){if(!aW.__timeout){aW.__timeout=setTimeout(function(){aW.popover("hide")},250)}});function aV(){if(aW.__timeout){clearTimeout(aW.__timeout);aW.__timeout=null}}var aX=aW.data("popover").tip().mouseenter(aV);aX.find("textarea").focus(aV);aX.mouseleave(function(){aW.__timeout=setTimeout(function(){aW.popover("hide")},250)});aX.find("i").unbind().click(function(){aW.popover("hide")});aX.find("button").click(function(){var aZ=stripHTML(aX.find("textarea").val()).replace(/'/g,"").replace(/"/g,"");if(aZ.length>0){b[aY]=aZ;ah()}c()})})(aT,aU)}function aI(aT,aU,aV){(function(aW,aX,aZ){aW=$(aW);if(!aW.data("popover")){var a0="Note";if(b[aZ]){a0+=' <span style="float:right"><img src="'+resource+'delete.png" /></span>'}$(aW).popover({title:a0,trigger:"manual",content:$("<div/>").html(aX).text()})}else{if(aW.data("popover").tip().is(":visible")){return}}aW.popover("show");aW.mouseleave(function(){if(!aW.__timeout){aW.__timeout=setTimeout(function(){aW.popover("hide")},250)}});var aY=aW.data("popover").tip().mouseenter(function(){if(aW.__timeout){clearTimeout(aW.__timeout);aW.__timeout=null}});aY.find("img").unbind().click(function(){h.deleteNote(aZ)});aY.mouseleave(function(){aW.__timeout=setTimeout(function(){aW.popover("hide")},250)})})(aT,aU,aV)}function C(aW,a1,aY){var a2=aW.result;var aX='<tr class="pointer" id="tx-'+aW.txIndex+'"><td class="hidden-phone" style="width:365px"><div><ul style="margin-left:0px;" class="short-addr">';var aU=true;if(a2>=0){for(var aV=0;aV<aW.inputs.length;++aV){var aT=aW.inputs[aV].prev_out;if(!aT||!aT.addr){aU=false;aX+='<span class="label">Newly Generated Coins</span>'}else{var aZ=a1[aT.addr];if(aZ){continue}aU=false;aX+=formatOutput(aT,a1,aY)}}}else{if(a2<0){for(var aV=0;aV<aW.out.length;++aV){var aT=aW.out[aV];var aZ=a1[aT.addr];if(aZ&&aT.type==0){continue}aU=false;aX+=formatOutput(aT,a1,aY)}}}if(aU){aX+='<span class="label">Moved Between Wallet</info>'}aX+="</ul></div></td><td><div>";var a0=aW.note?aW.note:b[aW.hash];if(a0){aX+='<img src="'+resource+'note.png" class="show-note"> '}else{aX+='<img src="'+resource+'note_grey.png" class="add-note"> '}if(aW.time>0){aX+=dateToString(new Date(aW.time*1000))}if(aW.confirmations==0){aX+=' <span class="label label-important hidden-phone">Unconfirmed Transaction!</span> '}else{if(aW.confirmations>0){aX+=' <span class="label label-info hidden-phone">'+aW.confirmations+" Confirmations</span> "}}aX+="</div></td>";if(a2>0){aX+='<td style="color:green"><div>'+formatMoney(a2,true)+"</div></td>"}else{if(a2<0){aX+='<td style="color:red"><div>'+formatMoney(a2,true)+"</div></td>"}else{aX+="<td><div>"+formatMoney(a2,true)+"</div></td>"}}if(aW.balance==null){aX+="<td></td></tr>"}else{aX+='<td class="hidden-phone"><div>'+formatMoney(aW.balance)+"</div></td></tr>"}return aX}function V(){L();if(ax==null){$("#balance").html("Loading...")}else{$("#balance").html(formatSymbol(ax,symbol,true));$("#balance2").html(formatSymbol(ax,(symbol===symbol_local)?symbol_btc:symbol_local),true)}return j.attr("id")}function c(aT){var aU=V();if("send-coins"==aU){u(aT)}else{if("home-intro"==aU){f(aT)}else{if("receive-coins"==aU){aS(aT)}else{if("my-transactions"==aU){W(aT)}}}}}function f(aT){$("#summary-n-tx").html(K);$("#summary-received").html(formatMoney(ar,true));$("#summary-sent").html(formatMoney(S,true));$("#summary-balance").html(formatMoney(ax,symbol));var aV=h.getPreferredAddress();$("#tweet-for-btc").unbind().click(function(){window.open("https://twitter.com/share?url=https://blockchain.info/wallet&hashtags=tweet4btc,bitcoin,"+aV+"&text=Sign Up For a Free Bitcoin Wallet @ Blockchain.info","","toolbar=0, status=0, width=650, height=360")});$(".paper-wallet-btn").unbind().click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showModal()})});if(h.isWatchOnly(aV)){$(".no-watch-only").hide()}else{$(".no-watch-only").show();var aU=$("#my-primary-address");if(aU.text()!=aV){aU.text(aV);loadScript("wallet/jquery.qrcode",function(){$("#my-primary-addres-qr-code").empty().qrcode({width:125,height:125,text:aV})})}}}function T(){var aT=$("#export-warning").show();var aU=$("#import-export-content").hide();$("#show-import-export").unbind().click(function(){h.getMainPassword(function(){aT.hide();loadScript("wallet/import-export",function(){ImportExport.init(aU,function(){aU.show()},function(){ae($("#home-intro"))})},function(aV){h.makeNotice("error","misc-error",aV);ae($("#home-intro"))})},function(){ae($("#home-intro"))})})}function W(){var aU=null;var aW=0;if(aU!=null){clearInterval(aU);aU=null}var aT;if(s.tx_display==0){$("#transactions-detailed").hide();aT=$("#transactions-compact").show().find("tbody").empty()}else{$("#transactions-compact").hide();aT=$("#transactions-detailed").empty().show()}if(E.length==0){$("#transactions-detailed, #transactions-compact").hide();$("#no-transactions").show();return}else{$("#no-transactions").hide()}var aV=function(){for(var a0=aW;a0<E.length&&a0<(aW+10);++a0){var aZ=E[a0];if(s.tx_display==0){aT.append(aO($(C(aZ,I,g)),aZ))}else{aT.append(aZ.getHTML(I,g))}}aW+=10;if(aW<E.length){aU=setTimeout(aV,15)}else{setupSymbolToggle();L();var aY=$(".pagination ul").empty();if(av==0&&E.length<50){aY.hide();return}else{aY.show()}var aX=Math.ceil(aR/50);var a1=" disabled";if(av>0){a1=""}aY.append($('<li class="prev'+a1+'"><a>&larr; Previous</a></li>').click(function(){h.setPage(av-1)}));for(var a0=0;a0<aX&&a0<=10;++a0){(function(a2){var a3="";if(av==a2){a3=' class="active"'}aY.append($("<li"+a3+'><a class="hidden-phone">'+a2+"</a></li>").click(function(){h.setPage(a2)}))})(a0)}var a1=" disabled";if(av<aX){a1=""}aY.append($('<li class="next'+a1+'"><a>Next &rarr;</a></li>').click(function(){h.setPage(av+1)}))}};aV()}this.setPage=function(aT){av=aT;scroll(0,0);h.get_history()};function v(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Export History",description:"",src:root+"export-history?active="+h.getActiveAddresses().join("|")+"&archived="+h.getArchivedAddresses().join("|")})})}function H(aW,aV){if(!aV&&aW.mixer_fee){x=aW.mixer_fee}if(aW.disable_mixer){$("#shared-addresses,#send-shared").hide()}E.length=0;if(aW.wallet==null){ar=0;S=0;ax=0;K=0;aR=0;return}ar=aW.wallet.total_received;S=aW.wallet.total_sent;ax=aW.wallet.final_balance;K=aW.wallet.n_tx;aR=aW.wallet.n_tx_filtered;for(var aU=0;aU<aW.addresses.length;++aU){if(I[aW.addresses[aU].address]){I[aW.addresses[aU].address].balance=aW.addresses[aU].final_balance}}for(var aU=0;aU<aW.txs.length;++aU){var aT=TransactionFromJSON(aW.txs[aU]);aT.result=t(aT,false);E.push(aT)}if(aW.info){$("#nodes-connected").html(aW.info.nconnected);if(aW.info.latest_block){aw(aW.info.latest_block)}if(aW.info.symbol_local){setLocalSymbol(aW.info.symbol_local)}if(aW.info.symbol_btc){setBTCSymbol(aW.info.symbol_btc)}}}this.handleURI=function(aU,aT){loadScript("wallet/jsuri-1.1.1",function(){try{var aW=new Uri(aU);var aV=new Bitcoin.Address(aW.host());aT.find('input[name="send-to-address"]').val(aV.toString());var aX=parseFloat(aW.getQueryParamValue("amount"));if(aX>0&&!isNaN(aX)){aT.find('input[name="send-value"]').val(aX)}}catch(aY){console.log(aY);h.makeNotice("error","error","Invalid Bitcoin Address or URI")}},function(){h.makeNotice("error","error","Invalid Bitcoin Address or URI")})};function aK(){J();U=setTimeout(h.logout,h.getLogoutTime());for(var aV in Y){Y[aV]("did_decrypt")}MyStore.get("multiaddr",function(aX){if(aX!=null){H($.parseJSON(aX),true);c()}});h.get_history();$("#initial_error,#initial_success").remove();var aW=decodeURIComponent(window.location.hash.replace("#",""));if(aW.indexOf("bitcoin:")==0){var aT=$("#send-coins");ae(aT);var aU=aT.find(".tab-pane.active").find(".recipient").first();h.handleURI(aW,aU)}else{ae($("#home-intro"))}window.location.hash=""}function J(aW,aT){for(var aU in I){var aX=I[aU];if(aX.tag==1){alert("Warning! wallet data may have changed but cannot sync as you have un-saved keys");return}}console.log("Get wallet with checksum "+ay);var aV={method:"wallet.aes.json"};if(ay&&ay.length>0){aV.checksum=ay}h.securePost("wallet",aV,function(aY){if(aY==null||aY.length==0||aY=="Not modified"){if(aW){aW()}return}console.log("Wallet data modified");h.setEncryptedWalletData(aY);aa(function(){h.get_history();c();if(aW){aW()}},function(){window.location.reload();if(aT){aT()}})},function(aY){if(aT){aT()}})}function aa(aU,aT){if(ai==null||ai.length==0){aT("No Wallet Data To Decrypt");return}h.decryptWallet(ai,aG,function(aZ,aX){try{d=aZ.sharedKey;if(!d||d.length==0||d.length!=36){throw"Shared Key is invalid"}if(aX){Q=aX.version;P=aX.pbkdf2_iterations}if(aZ.double_encryption&&aZ.dpasswordhash){F=aZ.double_encryption;w=aZ.dpasswordhash}if(aZ.options){$.extend(s,aZ.options)}I={};for(var aW=0;aW<aZ.keys.length;++aW){var aV=aZ.keys[aW];if(aV.addr==null||aV.addr.length==0||aV.addr=="undefined"){h.makeNotice("error","null-error","Your wallet contains an undefined address. This is a sign of possible corruption, please double check all your BTC is accounted for. Backup your wallet to remove this error.",15000);continue}if(aV.tag==1){aV.tag=null}I[aV.addr]=aV}g={};if(aZ.address_book){for(var aW=0;aW<aZ.address_book.length;++aW){h.addAddressBookEntry(aZ.address_book[aW].addr,aZ.address_book[aW].label)}}if(aZ.tx_notes){b=aZ.tx_notes}if(ay==null||ay.length==0){ay=ag()}e();aU()}catch(aY){aT(aY)}},aT)}this.getPassword=function(aY,aZ,aW){if(!aY.is(":visible")){aY.trigger("hidden");aY.unbind()}aY.modal({keyboard:false,backdrop:"static",show:true});aY.center();var aX=aY.find('input[name="password"]');var a1=aX,aT=false,a0=false;aY.find(".vkeyboard li").unbind().click(function(){var a4=$(this),a3=a4.html();if(a4.hasClass("left-shift")||a4.hasClass("right-shift")){$(".letter").toggleClass("uppercase");$(".symbol span").toggle();aT=(aT===true)?false:true;a0=false;return false}if(a4.hasClass("capslock")){$(".letter").toggleClass("uppercase");a0=true;return false}if(a4.hasClass("delete")){var a2=a1.val();a1.val(a2.substr(0,a2.length-1));return false}if(a4.hasClass("symbol")){a3=$("span:visible",a4).html()}if(a4.hasClass("space")){a3=" "}if(a4.hasClass("tab")){a3="\t"}if(a4.hasClass("return")){a3="\n"}if(a4.hasClass("uppercase")){a3=a3.toUpperCase()}if(aT===true){$(".symbol span").toggle();if(a0===false){$(".letter").toggleClass("uppercase")}aT=false}a1.val(a1.val()+a3)});aX.keypress(function(a2){if(a2.keyCode==13){a2.preventDefault();aY.find(".btn.btn-primary").click()}});aX.val("");var aU=aY.find(".btn.btn-primary");aU.click(function(){if(aZ){aW=null;var a2=aZ;aZ=null;setTimeout(function(){aY.modal("hide");a2(aX.val())},10)}else{aY.modal("hide")}});var aV=aY.find(".btn.btn-secondary");aV.click(function(){if(aW){var a2=aW;aW=null;aZ=null;setTimeout(function(){aY.modal("hide");try{a2()}catch(a3){h.makeNotice("error","misc-error",a3)}},10)}else{aY.modal("hide")}});aY.on("hidden",function(){aX.unbind();aV.unbind();aU.unbind();aY.unbind();if(aW){var a2=aW;aW=null;aZ=null;setTimeout(function(){try{a2()}catch(a3){h.makeNotice("error","misc-error",a3)}},10)}})};this.makePairingQRCode=function(aU,aT){h.getMainPassword(function(){loadScript("wallet/jquery.qrcode",function(){try{if(aT==1){h.securePost("wallet",{method:"pairing-encryption-password"},function(aW){aU($("<div></div>").qrcode({width:300,height:300,text:"1|"+M+"|"+h.encrypt(d+"|"+Crypto.util.bytesToHex(UTF8.stringToBytes(aG)),aW,h.getDefaultPbkdf2Iterations())}))},function(aW){h.makeNotice("error","misc-error",aW)})}else{if(aT==0){aU($("<div></div>").qrcode({width:300,height:300,text:M+"|"+d+"|"+aG}))}}}catch(aV){h.makeNotice("error","misc-error",aV)}})},function(){h.logout()})};this.getMainPassword=function(aU,aT){if(B>new Date().getTime()-N){return aU(aG)}h.getPassword($("#main-password-modal"),function(aV){if(aG==aV){B=new Date().getTime();if(aU){try{aU(aG)}catch(aW){h.makeNotice("error","misc-error",aW)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aT){try{aT()}catch(aW){h.makeNotice("error","misc-error",aW)}}}},aT)};this.getSecondPassword=function(aV,aT){if(!F||ak!=null){if(aV){try{aV(ak)}catch(aU){h.makeNotice("error","misc-error",aU)}}return}h.getPassword($("#second-password-modal"),function(aW){try{if(aH(aW)){if(aV){try{aV(aW)}catch(aX){console.log(aX);h.makeNotice("error","misc-error",aX)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aT){try{aT()}catch(aX){h.makeNotice("error","misc-error",aX)}}}}catch(aX){if(aT){try{aT()}catch(aX){h.makeNotice("error","misc-error",aX)}}}},aT)};function a(){if(A){return}var aT=$("#restore-password");aG=aT.val();aT.val("");B=new Date().getTime();if(ai==null||ai.length==0){h.setLoadingText("Validating Authentication key");var aU=$.trim($(".auth-"+q).find(".code").val());if(aU.length==0||aU.length>255){h.makeNotice("error","misc-error","You must enter a Two Factor Authentication code");return false}$.ajax({type:"POST",url:root+"wallet",data:{guid:M,payload:aU,length:aU.length,method:"get-wallet",format:"plain"},success:function(aV){try{if(aV==null||aV.length==0){h.makeNotice("error","misc-error","Server Return Empty Wallet Data");return}if(aV!="Not modified"){h.setEncryptedWalletData(aV)}$(".auth-"+q).hide();$(".auth-0").show();aa(function(){n();aK()},function(aX){h.makeNotice("error","misc-error",aX)})}catch(aW){h.makeNotice("error","misc-error",aW)}},error:function(aV){h.makeNotice("error","misc-error",aV.responseText)}})}else{aa(function(){n();aK()},function(aV){h.makeNotice("error","misc-error",aV)})}}function O(){$("#not-synced-warning-modal").modal("show").find(".btn.btn-danger").unbind().click(function(){$(this).modal("hide");ap=true;c()})}function e(){at("error");webSocketConnect(y);A=true;$("#tech-faq").hide();$("#intro-text").hide();$("#large-summary").show()}this.quickSendNoUI=function(aV,aU,aT){loadScript("wallet/signer",function(){h.getSecondPassword(function(){try{var aX=initNewTx();aX.from_addresses=h.getActiveAddresses();aX.to_addresses.push({address:new Bitcoin.Address(aV),value:Bitcoin.Util.parseValue(aU)});aX.addListener(aT);aX.start()}catch(aW){aT.on_error(aW)}},function(aW){aT.on_error(aW)})})};function G(){h.setLoadingText("Sending email backup");h.securePost("wallet",{method:"email-backup"},function(aT){h.makeNotice("success","backup-success",aT)},function(aT){h.makeNotice("error","misc-error",aT.responseText)})}function ah(aW,aV,aU,aT){if(am){clearInterval(am);am=null}am=setTimeout(function(){h.backupWallet(aW,aV,aU,aT)},3000)}this.backupWallet=function(aZ,aY,aU){if(am){clearInterval(am);am=null}var aT=function(a0){h.makeNotice("error","misc-error","Error Saving Wallet: "+a0,10000);c();if(aU!=null){aU(a0)}else{throw a0}};try{if(aZ==null){aZ="update"}if(aC(I)==0){return}var aV=h.makeWalletJSON();var aX=h.encryptWallet(aV,aG);if(aX.length==0){throw"Error encrypting the JSON output"}h.decryptWallet(aX,aG,function(a2){try{var a0=ay;h.setLoadingText("Saving wallet");h.setEncryptedWalletData(aX);h.securePost("wallet",{length:aX.length,payload:aX,checksum:ay,old_checksum:a0,method:aZ,format:"plain"},function(a4){for(var a3 in I){var a5=I[a3];if(a5.tag==1){delete a5.tag}}h.makeNotice("success","misc-success",a4);c();if(aY!=null){aY()}},function(a4){for(var a3 in I){var a5=I[a3];if(a5.tag==1){O();break}}aT(a4.responseText)})}catch(a1){aT(a1)}})}catch(aW){aT(aW)}};function aL(aT){if(F){if(ak==null){throw"Cannot encrypt private key without a password"}return h.encrypt(aT,d+ak,h.getSecondPasswordPbkdf2Iterations())}else{return aT}return null}this.isBase58=function(aV,aU){for(var aT=0;aT<aV.length;++aT){if(aV[aT]<0||aV[aT]>58){return false}}return true};this.encrypt=function(aV,aU,aT){return Crypto.AES.encrypt(aV,aU,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aT})};this.encryptWallet=function(aU,aT){if(Q==2){return JSON.stringify({pbkdf2_iterations:h.getMainPasswordPbkdf2Iterations(),version:Q,payload:h.encrypt(aU,aT,h.getMainPasswordPbkdf2Iterations())})}else{if(Q==0){return h.encrypt(aU,aT,h.getDefaultPbkdf2Iterations())}else{throw"Unknown encryption version "+Q}}};this.decryptWallet=function(aU,a0,a1,aX){try{var aT=null;try{var aT=$.parseJSON(aU)}catch(aV){console.log(aV)}var aW=function(){try{var a3=Crypto.AES.decrypt(aT.payload,a0,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aT.pbkdf2_iterations});var a2=$.parseJSON(a3);a1(a2,aT)}catch(a4){aX("Error Decrypting Wallet. Please check your password is correct.")}};if(aT&&aT.payload&&aT.pbkdf2_iterations){if(aT.version!=ao){throw"Wallet version "+aT.version+" not supported"}if(aT.pbkdf2_iterations>100){var aZ=$("#decrypting-progress-modal");var aY=setTimeout(function(){aZ.modal({keyboard:false,backdrop:"static",show:true});aZ.center()},500);h.decryptWebWorker(aT.payload,a0,aT.pbkdf2_iterations,function(a3){clearTimeout(aY);aZ.modal("hide");try{var a2=$.parseJSON(a3);a1(a2,aT)}catch(a4){aW()}},function(){clearTimeout(aY);aZ.modal("hide");aW()})}else{aW()}}else{h.decrypt(aU,a0,h.getDefaultPbkdf2Iterations(),function(a3){try{var a2=$.parseJSON(a3);try{a1(a2)}catch(a4){console.log(a4)}return true}catch(a4){return false}},function(){aX("Error Decrypting Wallet. Please check your password is correct.")})}}catch(aV){if(aX){aX(aV)}}};this.decryptWebWorker=function(aW,a0,aV,a1,aZ){var aT=false;var aY=function(a2){if(!aT){aZ(a2);aT=true}};try{var aU=new Worker(resource+"wallet/signer"+(min?".min.js":".js"));aU.addEventListener("message",function(a3){var a2=a3.data;try{switch(a2.cmd){case"on_decrypt":a1(a2.data);aU.terminate();break;case"on_error":throw a2.e}}catch(a3){aU.terminate();aY(a3)}},false);aU.addEventListener("error",function(a2){aY(a2)});aU.postMessage({cmd:"load_resource",path:resource+"wallet/bitcoinjs"+(min?".min.js":".js")});aU.postMessage({cmd:"decrypt",data:aW,password:a0,pbkdf2_iterations:aV})}catch(aX){aY(aX)}};this.decrypt=function(aX,aW,aU,aZ,aV){try{var aT=Crypto.AES.decrypt(aX,aW,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aU});if(aT!=null&&aT.length>0){if(aZ(aT)){return aT}}}catch(aY){console.log(aY)}if(aU!=10){try{var aT=Crypto.AES.decrypt(aX,aW,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:10});if(aT!=null&&aT.length>0){if(aZ(aT)){return aT}}}catch(aY){console.log(aY)}}try{var aT=Crypto.AES.decrypt(aX,aW);if(aT!=null&&aT.length>0){if(aZ(aT)){return aT}}}catch(aY){console.log(aY)}try{var aT=Crypto.AES.decrypt(aX,aW,{mode:new Crypto.mode.OFB(Crypto.pad.iso7816),iterations:1});if(aT!=null&&aT.length>0){if(aZ(aT)){return aT}}}catch(aY){console.log(aY)}try{var aT=Crypto.AES.decrypt(aX,aW,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:1});if(aT!=null&&aT.length>0){if(aZ(aT)){return aT}}}catch(aY){console.log(aY)}if(aV){aV()}return null};this.setGUID=function(aV,aT){console.log("Set GUID "+aV);if(A){throw"Cannot Set GUID Once Initialized"}h.setLoadingText("Changing Wallet Identifier");$("#initial_error,#initial_success").remove();var aU=$("#restore-wallet-continue");aU.prop("disabled",true);var aX=(new Date()).getTime();var aW={format:"json",resend_code:aT,ct:aX};if(ay){aW.checksum=ay}$.ajax({type:"GET",dataType:"json",url:root+"wallet/"+aV,data:aW,timeout:10000,success:function(a1){var a0=(new Date()).getTime();if(a1.clientTimeDiff&&a1.serverTime){var aY=a0-a1.serverTime;var aZ=(a1.clientTimeDiff-a0+aX-aY)/2;aJ=(aY-aZ)/2;console.log("Server Time offset "+aJ+"ms")}aU.prop("disabled",false);if(!a1.guid){h.makeNotice("error","misc-error","Server returned null guid.");return}$(".auth-"+q).hide();Z=a1.extra_seed;M=a1.guid;q=a1.auth_type;aM=a1.real_auth_type;if(a1.language){X=a1.language}if(a1.payload&&a1.payload.length>0&&a1.payload!="Not modified"){h.setEncryptedWalletData(a1.payload)}war_checksum=a1.war_checksum;setLocalSymbol(a1.symbol_local);$("#restore-guid").val(M);$(".auth-"+q).show();if(a1.initial_error){h.makeNotice("error","misc-error",a1.initial_error)}if(a1.initial_success){h.makeNotice("success","misc-success",a1.initial_success)}MyStore.get("guid",function(a2){if(a2!=M){MyStore.clear();if(M!=D){MyStore.put("guid",M)}}})},error:function(aY){console.log("Set GUID Success");aU.prop("disabled",false);MyStore.get("guid",function(aZ){if(aZ==aV&&ai){h.makeNotice("error","misc-error","Error Contacting Server. Using Local Wallet Cache.");M=aZ;ay=ag();q=0;$("#restore-guid").val(M);$(".auth-"+q).show();return}try{var a1=$.parseJSON(aY.responseText);if(a1.initial_error){h.makeNotice("error","misc-error",a1.initial_error);return}}catch(a0){}if(aY.responseText){h.makeNotice("error","misc-error",aY.responseText)}else{h.makeNotice("error","misc-error","Error changing wallet identifier")}})}})};function i(aT){var aU=B58.encode(aT);return aL(aU)}this.decryptPK=function(aT){if(F){if(ak==null){throw"Cannot decrypt private key without a password"}return h.decrypt(aT,d+ak,h.getSecondPasswordPbkdf2Iterations(),h.isBase58)}else{return aT}return null};this.decodePK=function(aU){if(!aU){throw"null PK passed to decodePK"}var aT=h.decryptPK(aU);if(aT!=null){return B58.decode(aT)}return null};this.signmessage=function(aT,aV){var aX=I[aT];if(!aX.priv){throw"Cannot sign a watch only address"}var aW=h.decodePK(aX.priv);var aU=new Bitcoin.ECKey(aW);return Bitcoin.Message.signMessage(aU,aV,aX.addr)};function aH(aU){var aT=Crypto.SHA256(d+aU,{asBytes:true});var aX=ad(aT,h.getSecondPasswordPbkdf2Iterations()-1);if(aX==w){ak=aU;return true}if(h.getSecondPasswordPbkdf2Iterations()!=10){var aV=ad(aT,10-1);if(aV==w){ak=aU;w=aX;return true}}if(Crypto.util.bytesToHex(aT)==w){ak=aU;w=aX;return true}var aW=Crypto.SHA256(aU);if(aW==w){ak=aU;w=aX;return true}return false}this.runCompressedCheck=function(){var aT=[];var aV={};for(var aW in I){var a0=I[aW];if(a0.priv!=null){var aZ=h.decodePK(a0.priv);var aX=new Bitcoin.ECKey(aZ);var aU=aX.getBitcoinAddress().toString();var aY=aX.getBitcoinAddressCompressed().toString();if(a0.addr!=aU){aV[aU]=a0.priv;aT.push(aU)}if(a0.addr!=aY){aV[aY]=a0.priv;aT.push(aY)}}}if(aT.length==0){alert("to_check length == 0")}BlockchainAPI.get_balances(aT,function(a2){var a3=0;for(var a1 in a2){var a4=a2[a1].final_balance;if(a4>0){alert(formatBTC(a4)+" claimable in address "+a1+" (Import PK : "+h.base58ToSipa(aV[a1],a1)+")")}a3+=a4}alert(formatBTC(a4)+" found in compressed addresses")})};this.checkAllKeys=function(aT){for(var aU in I){var aY=I[aU];if(aY.addr==null){throw"Null Address Found in wallet "+aU}if(aY.addr.toString()==null){throw"Error decoding wallet address "+aY.addr}if(aY.priv!=null){var aX=h.decodePK(aY.priv);var aW=new Bitcoin.ECKey(aX);var aV=aW.getBitcoinAddress().toString();if(aV!=aY.addr&&aW.getBitcoinAddressCompressed().toString()!=aY.addr){throw"Private key does not match bitcoin address "+aY.addr+" != "+aV}if(aT){aY.priv=i(aX)}}}h.makeNotice("success","wallet-success","Wallet verified.")};this.setMainPassword=function(aT){h.getMainPassword(function(){aG=aT;h.backupWallet("update",function(){h.logout()},function(){h.logout()})})};function ae(aT){if(aT===j){return}if(j!=null){if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","")}j.hide()}j=aT;j.show();if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","active")}c(true)}function aC(aV){var aU=0,aT;for(aT in aV){aU++}return aU}function ac(aT){I[aT].priv=null}function aj(){if(aC(I)>=aA){h.makeNotice("error","misc-error","We currently support a maximum of "+aA+" private keys, please remove some unused ones.");return true}return false}function aP(aV,aT){var aU=I[aV];if(!aU||aU.length==0){I[aV]={addr:aV,priv:aT,balance:0};return true}else{if(!aU.priv&&aT){aU.priv=aT;return true}}return false}function o(){var aV=$("#add-address-book-entry-modal");aV.modal({keyboard:true,backdrop:"static",show:true});var aT=aV.find('input[name="label"]');var aU=aV.find('input[name="address"]');aT.val("");aU.val("");aV.find(".btn.btn-primary").unbind().click(function(){aV.modal("hide");var aX=stripHTML(aT.val());var aW=stripHTML(aU.val());if(aX.length==0||aW.length==0){h.makeNotice("error","misc-error","You must enter an address and label for the address book entry");return false}var aZ;try{aZ=new Bitcoin.Address(aW);if(aZ==null){throw"Null address"}}catch(aY){h.makeNotice("error","misc-error","Bitcoin address invalid, please make sure you entered it correctly");return false}if(g[aW]!=null){h.makeNotice("error","misc-error","Bitcoin address already exists");return false}h.makeNotice("success","misc-success","Added Address book entry");h.addAddressBookEntry(aW,aX);ah();$("#send-coins").find(".tab-pane").trigger("show",true)});aV.find(".btn.btn-secondary").unbind().click(function(){aV.modal("hide")})}this.logout=function(){if(U){clearTimeout(U)}if(M==D){window.location=root+"wallet/logout"}else{$.ajax({type:"GET",url:root+"wallet/logout",data:{format:"plain"},success:function(aT){window.location.reload()},error:function(){window.location.reload()}})}};function an(aZ){var a1=$("#delete-address-modal");a1.modal({keyboard:true,backdrop:"static",show:true});a1.find(".btn.btn-primary").hide();a1.find(".btn.btn-danger").hide();$("#change-mind").hide();a1.find("#to-delete-address").html(aZ.join(" "));a1.find("#delete-balance").empty();var aV=a1.find("#delete-balance");var aT=[];for(var aY in aZ){var a0=aZ[aY];if(I[a0]&&I[a0].priv){aT.push(aZ[aY])}}BlockchainAPI.get_balance(aT,function(a2){a1.find(".btn.btn-primary").show(200);a1.find(".btn.btn-danger").show(200);aV.html("Balance "+formatBTC(a2));if(a2>0){aV.css("color","red")}else{aV.css("color","black")}},function(){a1.find(".btn.btn-primary").show(200);a1.find(".btn.btn-danger").show(200);aV.text("Error Fetching Balance")});var aW=false;var aY=0;var aU=null;var aX=10;changeMind=function(){$("#change-mind").show();$("#change-mind-time").text(aX-aY)};a1.find(".btn.btn-primary").unbind().click(function(){changeMind();a1.find(".btn.btn-primary").hide();a1.find(".btn.btn-danger").hide();aU=setInterval(function(){if(aW){return}++aY;changeMind();if(aY==aX){$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Private Key Removed From Wallet");for(var a2 in aZ){ac(aZ[a2])}c();h.backupWallet();clearInterval(aU)}},1000)});a1.find(".btn.btn-danger").unbind().click(function(){changeMind();a1.find(".btn.btn-primary").hide();a1.find(".btn.btn-danger").hide();aU=setInterval(function(){if(aW){return}++aY;changeMind();if(aY==aX){try{$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Address & Private Key Removed From Wallet");for(var a2 in aZ){h.deleteAddress(aZ[a2])}c();h.backupWallet("update",function(){h.get_history()})}finally{clearInterval(aU)}}},1000)});a1.unbind().on("hidden",function(){if(aU){aW=true;clearInterval(aU);aU=null}});a1.find(".btn.btn-secondary").unbind().click(function(){a1.modal("hide")})}function az(){var aV=[];for(var aT in g){aV.push(g[aT])}for(var aT in I){var aU=I[aT];if(aU.tag!=2&&aU.label){aV.push(aU.label)}}return aV}function R(aT){h.getSecondPassword(function(){var aV=$("#sweep-address-modal");aV.modal("show");BlockchainAPI.get_balance(aT,function(aW){aV.find(".balance").text("Amount: "+formatBTC(aW))},function(){aV.find(".balance").text("Error Fetching Balance")});var aU=aV.find('select[name="change"]');l(aU,true);aV.find(".btn.btn-primary").unbind().click(function(){loadScript("wallet/signer",function(){BlockchainAPI.get_balance(aT,function(aW){var aX=initNewTx();aX.fee=aX.base_fee;aX.to_addresses.push({address:new Bitcoin.Address($.trim(aU.val())),value:BigInteger.valueOf(aW).subtract(aX.fee)});aX.from_addresses=aT;aX.start()},function(){h.makeNotice("error","misc-error","Error Getting Address Balance")})});aV.modal("hide")});aV.find(".btn.btn-secondary").unbind().click(function(){aV.modal("hide")})})}function aB(){try{$(".pop").popover({offset:10,placement:"bottom"})}catch(aT){}}function n(){$("#add-address-book-entry-btn").click(function(){o()});$("#home-intro-btn").click(function(){ae($("#home-intro"))});$("#my-transactions-btn").click(function(){ae($("#my-transactions"))});$("#send-coins-btn").click(function(){ae($("#send-coins"))});$("#import-export-btn").click(function(){ae($("#import-export"));T()});$("#chord-diagram").click(function(){window.open(root+"taint/"+h.getActiveAddresses().join("|"),null,"width=850,height=850")});$("#verify-message").click(function(){loadScript("wallet/address_modal",function(){verifyMessageModal()})});$("#generate-cold-storage").click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showColdStorageModal()},null,true)});$("#group-received").click(function(){loadScript("wallet/taint_grouping",function(){try{loadTaintData()}catch(aT){h.makeNotice("error","misc-error","Unable To Load Taint Grouping Data")}})});$("#my-account-btn").click(function(){ae($("#my-account"));var aT=$("#account-settings-warning").show();var aU=$("#my-account-content").hide();$("#show-account-settings").unbind().click(function(){h.getMainPassword(function(){aT.hide();loadScript("wallet/account",function(){AccountSettings.init(aU,function(){aU.show()},function(){ae($("#home-intro"))})},function(aV){h.makeNotice("error","misc-error",aV);ae($("#home-intro"))})},function(){ae($("#home-intro"))})})});$("#enable_archived_checkbox").change(function(){var aT=$(this).is(":checked");$(".archived_checkbox").prop("checked",false);$(".archived_checkbox").prop("disabled",!aT);$("#archived-sweep").prop("disabled",!aT);$("#archived-delete").prop("disabled",!aT)});$("#shared-addresses").on("show",function(){var aT=$(this);loadScript("wallet/shared-addresses",function(){buildSharedTable(aT)})});$("#active-addresses").on("show",function(){var aZ=$(this).find("table:first");aZ.find("tbody:gt(0)").remove();var aW=aZ.find("tbody").empty();for(var aY in I){var a0=I[aY];if(a0.tag==2||(a0.tag==1&&!ap)){continue}var aX="";if(a0.tag==1){aX=' <font color="red" class="pop" title="Not Synced" data-content="This is a new address which has not yet been synced with our the server. Do not used this address yet.">(Not Synced)</font>'}else{if(a0.priv==null){aX=' <font color="red" class="pop" title="Watch Only" data-content="Watch Only means there is no private key associated with this bitcoin address. <br /><br /> Unless you have the private key stored elsewhere you do not own the funds at this address and can only observe the transactions.">(Watch Only)</font>'}}var aT="";var aV=a0.addr;if(a0.label!=null){aV=a0.label;aT='<span class="hidden-phone"> - '+a0.addr+"</span>"}var aU=$('<tr><td><div class="short-addr"><a href="'+root+"address/"+a0.addr+'" target="new">'+aV+"</a>"+aT+" "+aX+'<div></td><td><span style="color:green">'+formatMoney(a0.balance,true)+'</span></td>            <td><div class="btn-group pull-right"><a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#"><span class="hidden-phone">Actions </span><span class="caret"></span></a><ul class="dropdown-menu">             <li><a href="#" class="pop act-archive" title="Archive Address" data-content="Click this button to hide the address from the main view. You can restore or delete later by finding it in the Archived addresses tab.">Archive Address</a></li>            <li><a href="#" class="pop act-label" title="Label Address" data-content="Set the label for this address.">Label Address</a></li>            <li><a href="#" class="pop act-qr" title="Show QR Code" data-content="Show a QR Code for this address.">QR Code</a></li>            <li><a href="#" class="pop act-sign" title="Sign Message" data-content="Sign A message with this address.">Sign Message</a></li>            <li><a href="#" class="pop act-request" title="Request Payment" data-content="Click here to create a new QR Code payment request. The QR Code can be scanned using most popular bitcoin software and mobile apps.">Create Payment Request</a></li>            <li><a href="#" class="pop act-pubkey">Show Public Key</a></li>            </ul></div></td></tr>');(function(a1){aU.find(".act-archive").click(function(){h.archiveAddr(a1)});aU.find(".act-label").click(function(){loadScript("wallet/address_modal",function(){showLabelAddressModal(a1)})});aU.find(".act-qr").click(function(){loadScript("wallet/address_modal",function(){showAddressModalQRCode(a1)})});aU.find(".act-pubkey").click(function(){h.getSecondPassword(function(){var a2=h.getPrivateKey(a1);if(a2==null){h.makeNotice("eror","misc-error","Public Key Unknown");return}var a3=new Bitcoin.ECKey(h.decodePK(a2));if(a3.getBitcoinAddressCompressed().toString()==a1){var a4=a3.getPubCompressed()}else{var a4=a3.getPub()}h.makeNotice("success","pub-key","Public Key of "+a1+" is "+Crypto.util.bytesToHex(a4),20000)})});aU.find(".act-sign").click(function(){loadScript("wallet/address_modal",function(){showAddressModalSignMessage(a1)})});aU.find(".act-request").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Create Payment Request",description:"Request Payment into address <b>"+a1+"</b>",src:root+"payment_request?address="+a1})})})})(a0.addr);if(a0.balance>0&&a0.priv){aZ.prepend(aU)}else{aZ.append(aU)}}aB()});$("#archived-addresses").on("show",function(){$("#enable_archived_checkbox").prop("checked",false);$("#archived-delete").prop("disabled",true);$("#archived-sweep").prop("disabled",true);$("#archived-addr tbody").empty();var aU=$(this).find("tbody");var aT=h.getArchivedAddresses();var aV=function(){aU.empty();for(var aZ in aT){var a1=I[aT[aZ]];if(a1.tag!=2||(a1.tag==1&&!ap)){continue}var aY="";if(a1.priv==null){aY=' <font color="red">(Watch Only)</font>'}var aW="";var aX=a1.addr;if(a1.label!=null){aX=a1.label;aW='<span class="hidden-phone"> - '+a1.addr+"</span>"}var a0=$('<tr><td style="width:20px;"><input type="checkbox" class="archived_checkbox" value="'+a1.addr+'" disabled></td><td><div class="short-addr"><a href="'+root+"address/"+a1.addr+'" target="new">'+aX+"</a>"+aW+" "+aY+'<div></td><td><span style="color:green">'+formatBTC(a1.balance)+'</span></td><td style="width:16px"><img src="'+resource+'unarchive.png" class="act-unarchive" /></td></tr>');(function(a2){a0.find(".act-unarchive").click(function(){h.unArchiveAddr(a2)})})(a1.addr);if(a1.balance>0&&a1.priv){aU.prepend(a0)}else{aU.append(a0)}}};aV();BlockchainAPI.get_balances(aT,function(aW){aV()},function(aW){h.makeNotice("error","misc-error",aW)})});$("#archived-sweep").click(function(){var aT=[];$(".archived_checkbox:checked").each(function(){var aU=I[$(this).val()];if(aU.priv==null){h.makeNotice("error","misc-error","Cannot Sweep Watch Only Address");return}aT.push(aU.addr)});if(aT.length==0){return}R(aT)});$("#archived-delete").click(function(){var aT=[];$(".archived_checkbox:checked").each(function(){aT.push($(this).val())});if(aT.length==0){return}an(aT)});$("#shared-never-ask").click(function(){SetCookie("shared-never-ask",$(this).is(":checked"))});$(".bitstamp-btn").click(function(){window.open(root+"r?url=https://www.bitstamp.net/?blockchaininfo=1",null,"scroll=1,status=1,location=1,toolbar=1,width=1000,height=700")});$(".deposit-btn").click(function(){var aV=$(this);var aU=h.getPreferredAddress();var aT=aV.data("extra");if(aT==null){aT=""}loadScript("wallet/frame-modal",function(){showFrameModal({title:aV.data("title"),description:"Deposit into address <b>"+aU+"</b>",top_right:'Have Questions? Read <a href="'+aV.data("link")+'" target="new">How It Works</a>',src:root+"deposit?address="+aU+"&ptype="+aV.data("type")+"&guid="+M+aT})})});$(".withdraw-btn").click(function(){var aT=$(this);h.getSecondPassword(function(){var aU=h.getPreferredAddress();loadScript("wallet/frame-modal",function(){showFrameModal({title:aT.data("title"),description:"Your Wallet Balance is <b>"+formatBTC(ax)+"</b>",src:root+"withdraw?method="+aT.data("type")+"&address="+aU+"&balance="+ax+"&guid="+M})})})});$("#logout").click(h.logout);$("#refresh").click(function(){J(null,function(aT){h.makeNotice("error","misc-error",aT.responseText)});h.get_history()});$("#summary-n-tx-chart").click(function(){window.open(root+"charts/n-transactions?show_header=false&address="+h.getActiveAddresses().join("|"),null,"scroll=0,status=0,location=0,toolbar=0,width=1000,height=700")});$("#summary-received-chart").click(function(){window.open(root+"charts/received-per-day?show_header=false&address="+h.getActiveAddresses().join("|"),null,"scroll=0,status=0,location=0,toolbar=0,width=1000,height=700")});$("#summary-balance-chart").click(function(){window.open(root+"charts/balance?show_header=false&address="+h.getActiveAddresses().join("|"),null,"scroll=0,status=0,location=0,toolbar=0,width=1000,height=700")});$("#new-addr").click(function(){try{J(function(){h.getSecondPassword(function(){var aV=h.generateNewKey();if(!aV){return}var aU=aV.getBitcoinAddress().toString();h.backupWallet("update",function(){h.makeNotice("info","new-address","Generated new Bitcoin Address "+aU);loadScript("wallet/address_modal",function(){showLabelAddressModal(aU)})})})})}catch(aT){h.makeNotice("error","misc-error",aT)}});$(".tx_filter a").click(function(){av=0;aq=$(this).data("value");h.get_history()});$(".tx_display a").click(function(){var aT=$(this).data("value");if(aT=="export"){v();return}s.tx_display=aT;c();ah()});$("#email-backup-btn").click(function(){G()});$("#dropbox-backup-btn").click(function(){window.open(root+"wallet/dropbox-login?guid="+M)});$("#gdrive-backup-btn").click(function(){window.open(root+"wallet/gdrive-login?guid="+M)});$("#large-summary").click(function(){toggleSymbol();c()});$("#send-quick").on("show",function(aV,aU){var aT=$(this);r(aT,aU);aT.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aT,"quick",initNewTx())})})});$("#send-email").on("show",function(aV,aU){var aT=$(this);r(aT,aU);aT.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aT,"email",initNewTx())})})});$("#send-shared").on("show",function(aV,aU){var aT=$(this);r(aT,aU);aT.find(".mixer_fee").text(x);aT.find(".fees,.free,.bonus").show();if(x<0){aT.find(".fees,.free").hide()}else{if(x==0){aT.find(".fees,.bonus").hide()}else{aT.find(".free,.bonus").hide()}}aT.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aT,"shared",initNewTx())})});aT.find(".shared-fees").text("0.00");aT.find('input[name="send-before-fees"]').unbind().bind("keyup change",function(){var aX=parseFloat($(this).val());var aW=0;if(aX>0){if(x>0){aW=parseFloat(aX+((aX/100)*x))}else{aW=parseFloat(aX);aT.find(".bonus-value").text(formatPrecision((Math.min(aX,precisionFromBTC(200))/100)*x))}}if(precisionToBTC(aX)<0.1||precisionToBTC(aX)>250){aT.find(".shared-fees").text("0.00");aT.find(".send").prop("disabled",true)}else{aT.find(".shared-fees").text(formatBTC(aW*symbol_btc.conversion));aT.find(".send").prop("disabled",false)}aT.find('input[name="send-value"]').val(aW).trigger("keyup")})});$("#send-custom").on("show",function(aV,aU){var aT=$(this);r(aT,aU);aT.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aT,"custom",initNewTx())})});aT.find('select[name="from"]').unbind().change(function(){var aY=0;var aW=$(this).val();for(var aX in aW){if(aW[aX]=="any"){$(this).val("any");aY=ax;break}else{var aZ=I[aW[aX]];if(aZ&&aZ.balance){aY+=aZ.balance}}}aT.find(".amount-available").text(formatBTC(aY))}).trigger("change");aT.find(".reset").unbind().click(function(){r(aT,true);aT.find('select[name="from"]').trigger("change")})});$("#send-satoshi-dice,#send-btcdice-dice").on("show",function(aV,aU){var aT=this;loadScript("wallet/dicegames",function(){try{DICEGame.init($(aT))}catch(aW){h.makeNotice("error","misc-error","Unable To Load Dice Bets")}},function(aW){h.makeNotice("error","misc-error",aW)})});$("#send-sms").on("show",function(aV,aU){if(aU){return}var aT=$(this);r(aT);$.ajax({type:"GET",url:resource+"wallet/country_codes.html",success:function(aW){aT.find('select[name="sms-country-code"]').html(aW)},error:function(){h.makeNotice("error","misc-error","Error Downloading SMS Country Codes")}});aT.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){var aW=initNewTx();startTxUI(aT,"sms",aW)})})});$("#address-book").on("show",function(){var aU=$("#address-book-tbl tbody");if(aC(g)>0){aU.empty();for(var aT in g){var aV=$("<tr><td>"+g[aT]+'</td><td><div class="addr-book-entry">'+aT+'</div></td><td style="width:16px" class="hidden-phone"><img src="'+resource+'delete.png" class="act-delete" /></td></tr>');(function(aW){aV.find(".act-delete").click(function(){h.deleteAddressBook(aW)})})(aT);aU.append(aV)}}});$('a[data-toggle="tab"]').unbind().on("show",function(aT){$(aT.target.hash).trigger("show")});$("#receive-coins-btn").click(function(){ae($("#receive-coins"))});$(".show_adv").click(function(){$(".modal:visible").center()});$(".download-backup-btn").show();aB()}function p(){$(".resend-code").click(function(){h.setGUID(M,true)});$("#reset-two-factor-btn").click(function(){window.location=root+"wallet/reset-two-factor"+(M?"?guid="+M:"")});$(".recover-wallet-btn").click(function(){window.location=root+"wallet/forgot-password"+(M?"?guid="+M:"")});$(".download-backup-btn").toggle(ai!=null).click(function(){if(!ai){h.makeNotice("error","error","No Wallet Data to Download");return}if(window.Blob&&window.URL){loadScript("wallet/filesaver",function(){var aU=new Blob([ai],{type:"text/plain;charset=utf-8"});saveAs(aU,"wallet.aes.json")})}else{var aT=window.open(null,null,"width=700,height=800,toolbar=0");aT.document.write('<!DOCTYPE html><html><head></head><body><div style="word-wrap:break-word;" >'+ai+"</div></body></html>")}aQ()});$(".auth-0,.auth-1,.auth-2,.auth-3,.auth-4,.auth-5").unbind().keypress(function(aT){if(aT.keyCode==13){aT.preventDefault();$("#restore-wallet-continue").click()}});$("#restore-wallet-continue").unbind().click(function(aU){aU.preventDefault();var aT=$.trim($("#restore-guid").val());if(aT.length==0){return}if(M!=aT){h.setGUID(aT,false)}else{a()}});$(".modal").on("show",function(){L();$(this).center()}).on("shown",function(){L();$(this).center()})}function al(aU){var aV=Crypto.SHA256(aU+"?");switch(aV.slice(0,2)){case"00":var aW=Crypto.SHA256(aU,{asBytes:true});return aW;break;case"01":var aT=Crypto.util.hexToBytes(aV.slice(2,4))[0];var aX=Math.round(Math.pow(2,(aT/4)));var aW=Crypto.PBKDF2(aU,"Satoshi Nakamoto",32,{iterations:aX,asBytes:true});return aW;break;default:console.log("invalid key");break}}function aF(){var aV,aT="";if(window.getSelection){aV=window.getSelection();if(aV.rangeCount){var aW=aV.getRangeAt(0).cloneContents();var aU=document.createElement("div");aU.appendChild(aW);aT=aU.innerText}}else{if(document.selection&&document.selection.type=="Text"){aT=document.selection.createRange().htmlText}}return aT}this.detectPrivateKeyFormat=function(aU){if(/^5[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(aU)){return"sipa"}if(/^[LK][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(aU)){return"compsipa"}if(/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{44}$/.test(aU)||/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{43}$/.test(aU)){return"base58"}if(/^[A-Fa-f0-9]{64}$/.test(aU)){return"hex"}if(/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(aU)){return"base64"}if(/^6P[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{56}$/.test(aU)){return"bip38"}if(/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(aU)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(aU)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(aU)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{30}$/.test(aU)){var aT=Crypto.SHA256(aU+"?",{asBytes:true});if(aT[0]===0||aT[0]===1){return"mini"}}throw"Unknown Key Format "+aU};this.privateKeyStringToKey=function(aU,aW){var aT=null;if(aW=="base58"){aT=B58.decode(aU)}else{if(aW=="base64"){aT=Crypto.util.base64ToBytes(aU)}else{if(aW=="hex"){aT=Crypto.util.hexToBytes(aU)}else{if(aW=="mini"){aT=al(aU)}else{if(aW=="sipa"){var aV=B58.decode(aU);aV.shift();aT=aV.slice(0,aV.length-4)}else{if(aW=="compsipa"){var aV=B58.decode(aU);aV.shift();aV.pop();aT=aV.slice(0,aV.length-4)}else{throw"Unsupported Key Format"}}}}}}if(aT.length!=32){throw"Result not 32 bytes in length"}return new Bitcoin.ECKey(aT)};$(document).ready(function(){if(!$.isEmptyObject({})){h.makeNotice("error","error","Object.prototype has been extended by a browser extension. Please disable this extensions and reload the page.");return}$("input,button,select").attr("autocomplete","off");var aU=$(document.body);function aV(){if(M&&M.length==36){setTimeout(function(){h.setGUID(M,false)},10)}}M=aU.data("guid");d=aU.data("sharedkey");if(h.skip_init){return}MyStore.get("payload",function(a0){if(ai==null&&a0!=null){ai=a0;ay=ag()}});if((!M||M.length==0)&&(isExtension||window.location.href.indexOf("/login")>0)){MyStore.get("guid",function(a0){M=a0;aV()})}else{aV()}if(top.location!=self.location){top.location=self.location.href}aU.click(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).keypress(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).mousemove(function(a0){if(a0){rng_seed_int(a0.clientX*a0.clientY)}});p();$(".auth-"+q).show();j=$("#restore-wallet");j.show();var aW=false;var aZ=17,aY=86,aT=67,aX=67;$(document).keydown(function(a1){try{if(a1.keyCode==aZ||a1.keyCode==aX){aW=true}if(aW&&a1.keyCode==aT){var a0=$.trim(aF());var a2=I[a0];if(a2!=null){if(a2.priv==null){$("#watch-only-copy-warning-modal").modal("show")}else{if(a2.tag==1){O()}}}}}catch(a1){console.log(a1)}}).keyup(function(a0){if(a0.keyCode==aZ||a0.keyCode==aX){aW=false}}).ajaxStart(function(){at("loading_start");$(".loading-indicator").fadeIn(200)}).ajaxStop(function(){at("loading_stop");$(".loading-indicator").hide()})});function aS(){$("#receive-coins").find(".tab-pane.active").trigger("show");setupToggle()}};